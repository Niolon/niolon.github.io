
    <div class="cifvis-container" style="width: 100%; height: 100%;">

        <!-- Import required libraries -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/14.0.1/math.js"></script>

        <style>
            .cifvis-container {
                background-color: white;
            }

            cifview-widget {
                background-color: white !important;
            }

            cifview-widget .control-button {
                background-color: #f5f5f5 !important;
                border: 1px solid #e0e0e0;
                transition: all 0.2s ease;
            }

            cifview-widget .control-button:hover {
                background-color: #e8e8e8 !important;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }

            cifview-widget .crystal-container {
                background-color: white;
            }
        </style>

        <cifview-widget 
            id="cifview"
            caption="Crystal Structure"
            style="width: 100%; height: 100%;">
        </cifview-widget>

        <script type="module">
            import * as THREE from 'https://cdnjs.cloudflare.com/ajax/libs/three.js/0.172.0/three.module.js';

            window.THREE = THREE;
            window.math = math.create(math.all);

            // Load the bundle
            (function(p,g){typeof exports=="object"&&typeof module<"u"?g(exports,require("three"),require("mathjs")):typeof define=="function"&&define.amd?define(["exports","three","mathjs"],g):(p=typeof globalThis<"u"?globalThis:p||self,g(p.CifVis={},p.THREE,p.math))})(this,function(p,g,y){"use strict";var Rt=Object.defineProperty;var mt=p=>{throw TypeError(p)};var zt=(p,g,y)=>g in p?Rt(p,g,{enumerable:!0,configurable:!0,writable:!0,value:y}):p[g]=y;var E=(p,g,y)=>zt(p,typeof g!="symbol"?g+"":g,y),pt=(p,g,y)=>g.has(p)||mt("Cannot "+y);var S=(p,g,y)=>(pt(p,g,"read from private field"),y?y.call(p):g.get(p)),ut=(p,g,y)=>g.has(p)?mt("Cannot add the same private member more than once"):g instanceof WeakSet?g.add(p):g.set(p,y),gt=(p,g,y,G)=>(pt(p,g,"write to private field"),G?G.call(p,y):g.set(p,y),y);var C;function G(l){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(l){for(const e in l)if(e!=="default"){const o=Object.getOwnPropertyDescriptor(l,e);Object.defineProperty(t,e,o.get?o:{enumerable:!0,get:()=>l[e]})}}return t.default=l,Object.freeze(t)}const c=G(g);function U(l,t=!0){const e=/([+-]?)(\d+\.?\d*)\((\d{1,2})\)/,o=l.match(e);let s,r;if(t&&o){const[a,i,d,n]=o,f=i==="-"?-1:1;if(d.includes(".")){const h=d.split(".")[1].length;s=Number((f*parseFloat(d)).toFixed(h)),r=Number((Math.pow(10,-h)*parseFloat(n)).toFixed(h))}else s=f*parseInt(d),r=parseInt(n)}else isNaN(l)?/^".*"$/.test(l)||/^'.*'$/.test(l)?s=l.slice(1,-1).replace(/\\([^\\])/g,"$1"):s=l.replace(/\\([^\\])/g,"$1"):s=l.includes(".")?parseFloat(l):parseInt(l),r=NaN;return{value:s,su:r}}function tt(l,t){let e="",o=t+1;for(;o<l.length&&l[o]!==";";)e+=l[o].replace(/\\([^\\])/g,"$1")+`
`,o++;return{value:e.trim(),endIndex:o}}class et{constructor(t,e=!0){this.splitSU=e,this.rawCifBlocks=this.splitCifBlocks(`

`+t),this.blocks=Array(this.rawCifBlocks.length).fill(null)}splitCifBlocks(t){const e=[],o=t.split(/\ndata_/).slice(1);let s=0;for(;s<o.length;){let r=o[s];const a=/^\s*;[\s\w]*$/gm,i=r.match(a);let d=i?i.length:0;for(;d%2===1&&s+1<o.length;){s++,r+=`
data_`+o[s];const n=r.match(a);d=n?n.length:0}e.push(r),s++}return e}getBlock(t=0){return this.blocks[t]||(this.blocks[t]=new ot(this.rawCifBlocks[t],this.splitSU)),this.blocks[t]}getAllBlocks(){for(let t=0;t<this.blocks.length;t++)this.blocks[t]||(this.blocks[t]=new ot(this.rawCifBlocks[t],this.splitSU));return this.blocks}}class ot{constructor(t,e=!0){this.rawText=t,this.splitSU=e,this.data=null,this.dataBlockName=null}parse(){if(this.data!==null)return;this.data={};const t=this.rawText.replace(/\n;([^\n^\s])/,`
;
$1`).split(`
`).map(o=>{const s=/#(?=(?:[^"]*"[^"]*")*[^"]*$)(?=(?:[^']*'[^']*')*[^']*$)/;return o.split(s)[0]}).map(o=>o.trim()).filter(o=>o.length>0);this.dataBlockName=t[0];let e=1;for(;e<t.length;){if(t[e+1]===";"){const s=tt(t,e+1);this.data[t[e]]=s.value,e=s.endIndex+1;continue}if(t[e].startsWith("loop_")){const s=new W(t.slice(e),this.splitSU);this.data[s.getName()]=s,e+=s.getEndIndex();continue}const o=t[e].match(/^(_\S+)\s+(.*)$/);if(o){const s=o[1],r=U(o[2],this.splitSU);this.data[s]=r.value,isNaN(r.su)||(this.data[s+"_su"]=r.su)}else if(t[e].startsWith("_")&&!t[e+1].startsWith("_")){const s=t[e],r=U(t[e+1],this.splitSU);this.data[s]=r.value,isNaN(r.su)||(this.data[s+"_su"]=r.su),e++}else throw new Error("Could not parse line "+String(e)+": "+t[e]);e++}}get dataBlockName(){return this._dataBlockName||this.parse(),this._dataBlockName}set dataBlockName(t){this._dataBlockName=t}get(t,e=null){this.parse();const o=Array.isArray(t)?t:[t];for(const s of o){const r=this.data[s];if(r!==void 0)return r}if(e!==null)return e;throw new Error(`None of the keys [${o.join(", ")}] found in CIF block`)}}class W{constructor(t,e){this.splitSU=e;let o=1;for(;o<t.length&&t[o].startsWith("_");)o++;this.headerLines=t.slice(1,o);let s=o;for(;s<t.length&&!t[s].startsWith("_")&&!t[s].startsWith("loop_");)s++;this.dataLines=t.slice(o,s),this.endIndex=s,this.headers=null,this.data=null,this.name=null,this.name=this.findCommonStart()}parse(){if(this.data!==null)return;this.headers=[...this.headerLines],this.data={};const t=[];let e=0;for(;e<this.dataLines.length;){const s=this.dataLines[e];if(s===";"){const i=tt(this.dataLines,e);t.push(U(i.value,this.splitSU)),e=i.endIndex+1;continue}const r=/('[^']+'|"[^"]+"|[^\s'"]+)/g,a=s.match(r);if(a)for(const i of a)t.push(U(i,this.splitSU));e++}const o=this.headers.length;if(t.length%o!=0)throw new Error(`Loop ${this.name}: Cannot distribute ${t.length} values evenly into ${o} columns`);if(t.length===0)throw new Error(`Loop ${this.name} has no data values.`);for(let s=0;s<o;s++){const r=this.headers[s],a=t.slice(s).filter((d,n)=>n%o===0);a.some(d=>!isNaN(d.su))?(this.data[r]=a.map(d=>d.value),this.data[r+"_su"]=a.map(d=>d.su),this.headers.push(r+"_su")):this.data[r]=a.map(d=>d.value)}}findCommonStart(){if(this.headerLines.length===1)return this.headerLines[0].trim();const t=this.headerLines[0],e="_"+t.split(/[\.\_]/)[1],o=this.headerLines.filter(r=>r.startsWith(e));let s="";for(let r=0;r<t.length;r++){const a=t[r];if(o.every(i=>i[r]===a))s+=a;else break}return s.slice(0,-1)}get(t,e=null){this.parse();const o=Array.isArray(t)?t:[t];for(const s of o){const r=this.data[s];if(r!==void 0)return r}if(e!==null)return e;throw new Error(`None of the keys [${o.join(", ")}] found in CIF loop ${this.name}`)}getIndex(t,e,o=null){this.parse();const s=Array.isArray(t)?t:[t];if(!s.some(a=>this.headers.includes(a))){if(o!==null)return o;throw new Error(`None of the keys [${s.join(", ")}] found in CIF loop ${this.name}`)}const r=this.get(s);if(e<r.length)return r[e];throw new Error(`Tried to look up value of index ${e} in ${this.name}, but length is only ${r.length}`)}getHeaders(){return this.headers||this.parse(),this.headers}getName(){return this.name}getEndIndex(){return this.endIndex}}const w=y.create(y.all,{});function A(l){const t=w.unit(l.alpha,"deg").toNumber("rad"),e=w.unit(l.beta,"deg").toNumber("rad"),o=w.unit(l.gamma,"deg").toNumber("rad"),s=Math.cos(t),r=Math.cos(e),a=Math.cos(o),i=Math.sin(o),d=Math.sqrt(1-s*s-r*r-a*a+2*s*r*a);return w.matrix([[l.a,l.b*a,l.c*r],[0,l.b*i,l.c*(s-r*a)/i],[0,0,l.c*d/i]])}function st(l){return w.matrix([[l[0],l[3],l[4]],[l[3],l[1],l[5]],[l[4],l[5],l[2]]])}function yt(l){const t=w.matrix(l);return[t.get([0,0]),t.get([1,1]),t.get([2,2]),t.get([0,1]),t.get([0,2]),t.get([1,2])]}function bt(l,t){const e=w.matrix(l),o=w.transpose(w.inv(e)),s=w.diag(w.matrix(w.transpose(o).toArray().map(d=>w.norm(d)))),r=st(t),a=w.multiply(w.multiply(s,r),w.transpose(s)),i=w.multiply(w.multiply(e,a),w.transpose(e));return yt(i)}const M=y.create(y.all);class T{constructor(t){const{matrix:e,vector:o}=this.parseSymmetryInstruction(t);this.rotMatrix=e,this.transVector=o}parseSymmetryInstruction(t){const e=Array(3).fill().map(()=>Array(3).fill(0)),o=Array(3).fill(0),s=t.split(",").map(r=>r.trim().toUpperCase());if(s.length!==3)throw new Error("Symmetry operation must have exactly three components");return s.forEach((r,a)=>{const i=/([+-]?\d*\.?\d*(?:\/\d+)?)\*?([XYZ])/g;let d;for(;(d=i.exec(r))!==null;){let h=d[1];const b=d[2];if(!h||h==="+")h="1";else if(h==="-")h="-1";else if(h.includes("/")){const[x,H]=h.split("/");h=parseFloat(x)/parseFloat(H)}h=parseFloat(h);const D=b==="X"?0:b==="Y"?1:2;e[a][D]=h}const f=r.replace(/[+-]?\d*\.?\d*(?:\/\d+)?\*?[XYZ]/g,"").match(/[+-]?\d*\.?\d+(?:\/\d+)?/g)||[];for(const h of f)if(h.includes("/")){const[b,D]=h.split("/");o[a]+=parseFloat(b)/parseFloat(D)}else o[a]+=parseFloat(h)}),{matrix:e,vector:o}}static fromCIF(t,e){let o=t.get(["_space_group_symop","_symmetry_equiv"],"InVaLIdValue");if(o=="InVaLIdValue"){for(const r of Object.entries(t.data))if((r[0].startsWith("_symmetry_equiv")||r[0].startsWith("_space_group_symop"))&&r[1]instanceof W){o=r[1];break}}if(o=="InVaLIdValue")throw new Error("No symmetry operations found in CIF block");const s=o.getIndex(["_space_group_symop.operation_xyz","_space_group_symop_operation_xyz","_symmetry_equiv.pos_as_xyz","_symmetry_equiv_pos_as_xyz"],e);return new T(s)}applyToPoint(t){const e=M.add(M.multiply(this.rotMatrix,t),this.transVector);return Array.isArray(e)?e:e.toArray()}applyToAtom(t){const e=new at(...M.add(M.multiply(this.rotMatrix,[t.position.x,t.position.y,t.position.z]),this.transVector));let o=null;if(t.adp&&t.adp instanceof $){const s=[[t.adp.u11,t.adp.u12,t.adp.u13],[t.adp.u12,t.adp.u22,t.adp.u23],[t.adp.u13,t.adp.u23,t.adp.u33]],r=this.rotMatrix,a=M.transpose(r),i=M.multiply(M.multiply(r,s),a);o=new $(i[0][0],i[1][1],i[2][2],i[0][1],i[0][2],i[1][2])}else t.adp&&t.adp instanceof q&&(o=new q(t.adp.uiso));return new z(t.label,t.atomType,e,o,t.disorderGroup)}applyToAtoms(t){return t.map(e=>this.applyToAtom(e))}copy(){const t=new T("x,y,z");return t.rotMatrix=M.clone(this.rotMatrix),t.transVector=M.clone(this.transVector),t}}class R{constructor(t,e,o){this.spaceGroupName=t,this.spaceGroupNumber=e,this.symmetryOperations=o}generateEquivalentPositions(t){return this.symmetryOperations.map(e=>e.applyToPoint(t))}applySymmetry(t,e){const[o,s]=t.split("_"),r=parseInt(o)-1;if(r<0||r>=this.symmetryOperations.length)throw new Error(`Invalid symmetry operation number: ${o}`);const a=s.split("").map(n=>parseInt(n)-5),i=this.symmetryOperations[r];if(Array.isArray(e)){const n=i.applyToAtoms(e);return n.forEach(f=>{f.position.x+=a[0],f.position.y+=a[1],f.position.z+=a[2]}),n}const d=i.applyToAtom(e);return d.position.x+=a[0],d.position.y+=a[1],d.position.z+=a[2],d}static fromCIF(t){let e,o;e=t.get(["_space_group.name_h-m_alt","_space_group.name_H-M_full","_symmetry_space_group_name_H-M","_space_group_name_H-M_alt"],"Unknown"),o=t.get(["_space_group.it_number","_space_group.IT_number","_symmetry_Int_Tables_number","_space_group_IT_number"],0);let s=t.get(["_space_group_symop","_symmetry_equiv"],"InVaLIdValue");if(s==="InVaLIdValue"){for(const i of Object.entries(t.data))if((i[0].startsWith("_symmetry_equiv")||i[0].startsWith("_space_group_symop"))&&i[1]instanceof W){s=i[1];break}}if(s=="InVaLIdValue")return console.warn("No symmetry operations found in CIF block, will use P1"),new R("Unknown",0,[new T("x,y,z")]);const a=s.get(["_space_group_symop.operation_xyz","_space_group_symop_operation_xyz","_symmetry_equiv.pos_as_xyz","_symmetry_equiv_pos_as_xyz"]).map((i,d)=>new T(i));return new R(e,o,a)}}const rt=y.create(y.all,{});class O{constructor(t,e,o=[],s=[],r=null){this.cell=t,this.atoms=e,this.bonds=o,this.hBonds=s,this.recalculateConnectedGroups(),this.symmetry=r||new R("None",0,["x,y,z"])}static fromCIF(t){const e=Y.fromCIF(t),s=t.get("_atom_site").get(["_atom_site.label","_atom_site_label"]),r=Array.from({length:s.length},(n,f)=>z.fromCIF(t,f)),a=[];try{const f=t.get("_geom_bond").get(["_geom_bond.atom_site_label_1","_geom_bond_atom_site_label_1"]).length;for(let h=0;h<f;h++)a.push(L.fromCIF(t,h))}catch{console.warn("No bonds found in CIF file")}const i=[];try{const f=t.get("_geom_hbond").get(["_geom_hbond.atom_site_label_d","_geom_hbond_atom_site_label_D"]).length;for(let h=0;h<f;h++)i.push(N.fromCIF(t,h))}catch{console.warn("No hydrogen bonds found in CIF file")}const d=R.fromCIF(t);return new O(e,r,a,i,d)}getAtomByLabel(t){for(const e of this.atoms)if(e.label===t)return e;throw new Error("Could not find atom with label: "+t)}recalculateConnectedGroups(){const t=new Map,e=[],o=r=>{if(t.has(r.label))return t.get(r.label);const a={atoms:new Set,bonds:new Set,hBonds:new Set};return e.push(a),a};for(const r of this.bonds){const a=this.getAtomByLabel(r.atom1Label),i=this.getAtomByLabel(r.atom2Label);if(r.atom2SiteSymmetry!=="."&&r.atom2SiteSymmetry!==null)continue;let d=t.get(a.label),n=t.get(i.label);const f=d||n;if(f){if(f.atoms.add(a),f.atoms.add(i),f.bonds.add(r),t.set(a.label,f),t.set(i.label,f),d&&n&&d!==n){for(const h of n.atoms)d.atoms.add(h),t.set(h.label,d);for(const h of n.bonds)d.bonds.add(h);e.splice(e.indexOf(n),1)}}else{const h=o(a);h.atoms.add(a),h.atoms.add(i),h.bonds.add(r),t.set(a.label,h),t.set(i.label,h)}}for(const r of this.hBonds){const a=this.getAtomByLabel(r.donorAtomLabel),i=this.getAtomByLabel(r.acceptorAtomLabel);if(r.acceptorAtomSymmetry!=="."&&r.acceptorAtomSymmetry!==null)continue;o(a).hBonds.add(r),t.has(i.label)&&o(i).hBonds.add(r)}this.atoms.filter(r=>!e.some(a=>a.atoms.has(r))).forEach(r=>{const a={atoms:new Set([r]),bonds:new Set,hBonds:new Set};e.push(a)}),this.connectedGroups=e.map(r=>({atoms:Array.from(r.atoms),bonds:Array.from(r.bonds),hBonds:Array.from(r.hBonds)}))}}class Y{constructor(t,e,o,s,r,a){this._a=t,this._b=e,this._c=o,this._alpha=s,this._beta=r,this._gamma=a,this.fractToCartMatrix=A(this)}static fromCIF(t){return new Y(t.get(["_cell.length_a","_cell_length_a"]),t.get(["_cell.length_b","_cell_length_b"]),t.get(["_cell.length_c","_cell_length_c"]),t.get(["_cell.angle_alpha","_cell_angle_alpha"]),t.get(["_cell.angle_beta","_cell_angle_beta"]),t.get(["_cell.angle_gamma","_cell_angle_gamma"]))}get a(){return this._a}set a(t){if(t<=0)throw new Error("Cell parameter 'a' must be positive");this._a=t,this.fractToCartMatrix=A(this)}get b(){return this._b}set b(t){if(t<=0)throw new Error("Cell parameter 'b' must be positive");this._b=t,this.fractToCartMatrix=A(this)}get c(){return this._c}set c(t){if(t<=0)throw new Error("Cell parameter 'c' must be positive");this._c=t,this.fractToCartMatrix=A(this)}get alpha(){return this._alpha}set alpha(t){if(t<=0||t>=180)throw new Error("Angle alpha must be between 0 and 180 degrees");this._alpha=t,this.fractToCartMatrix=A(this)}get beta(){return this._beta}set beta(t){if(t<=0||t>=180)throw new Error("Angle beta must be between 0 and 180 degrees");this._beta=t,this.fractToCartMatrix=A(this)}get gamma(){return this._gamma}set gamma(t){if(t<=0||t>=180)throw new Error("Angle gamma must be between 0 and 180 degrees");this._gamma=t,this.fractToCartMatrix=A(this)}}class z{constructor(t,e,o,s=null,r=0){this.label=t,this.atomType=e,this.position=o,this.adp=s,this.disorderGroup=r}static fromCIF(t,e=null,o=null){const s=t.get("_atom_site"),r=s.get(["_atom_site.label","_atom_site_label"]);let a=e;if(e===null&&o)a=r.indexOf(o);else if(e===null)throw new Error("either atomIndex or atomLabel need to be provided");const i=r[a],d=new at(s.getIndex(["_atom_site.fract_x","_atom_site_fract_x"],a),s.getIndex(["_atom_site.fract_y","_atom_site_fract_y"],a),s.getIndex(["_atom_site.fract_z","_atom_site_fract_z"],a)),n=s.getIndex(["_atom_site.adp_type","_atom_site_adp_type","_atom_site.thermal_displace_type","_atom_site_thermal_displace_type"],a,"Uiso");let f=null;if(n==="Uiso")f=new q(s.getIndex(["_atom_site.u_iso_or_equiv","_atom_site_U_iso_or_equiv"],a,.02));else if(n==="Uani"){const b=t.get("_atom_site_aniso"),x=b.get(["_atom_site_aniso.label","_atom_site_aniso_label"]).indexOf(i);if(x===null)throw new Error(`Atom ${i} as ADP type Uani, but was not found in atom_site_aniso.label`);f=new $(b.getIndex(["_atom_site_aniso.u_11","_atom_site_aniso_U_11"],x),b.getIndex(["_atom_site_aniso.u_22","_atom_site_aniso_U_22"],x),b.getIndex(["_atom_site_aniso.u_33","_atom_site_aniso_U_33"],x),b.getIndex(["_atom_site_aniso.u_12","_atom_site_aniso_U_12"],x),b.getIndex(["_atom_site_aniso.u_13","_atom_site_aniso_U_13"],x),b.getIndex(["_atom_site_aniso.u_23","_atom_site_aniso_U_23"],x))}const h=s.getIndex(["_atom_site.disorder_group","_atom_site_disorder_group"],a,".");return new z(i,s.getIndex(["_atom_site.type_symbol","_atom_site_type_symbol"],a),d,f,h==="."?0:h)}}const Q=class Q{constructor(t,e,o){ut(this,C);if(new.target===Q)throw new TypeError("BasePosition is an abstract class and cannot be instantiated directly, you probably want CartPosition");gt(this,C,[t,e,o]),Object.defineProperties(this,{0:{get:()=>S(this,C)[0]},1:{get:()=>S(this,C)[1]},2:{get:()=>S(this,C)[2]},length:{value:3},[Symbol.iterator]:{value:function*(){yield S(this,C)[0],yield S(this,C)[1],yield S(this,C)[2]}}})}get x(){return S(this,C)[0]}get y(){return S(this,C)[1]}get z(){return S(this,C)[2]}set x(t){S(this,C)[0]=t}set y(t){S(this,C)[1]=t}set z(t){S(this,C)[2]=t}toCartesian(t){throw new Error("toCartesian must be implemented by subclass")}};C=new WeakMap;let V=Q;class at extends V{constructor(t,e,o){super(t,e,o)}toCartesian(t){const e=rt.multiply(t.fractToCartMatrix,rt.matrix([this.x,this.y,this.z]));return new wt(...e.toArray())}}class wt extends V{constructor(t,e,o){super(t,e,o)}toCartesian(t){return this}}class q{constructor(t){this.uiso=t}}class ${constructor(t,e,o,s,r,a){this.u11=t,this.u22=e,this.u33=o,this.u12=s,this.u13=r,this.u23=a}getUCart(t){return bt(t.fractToCartMatrix,[this.u11,this.u22,this.u33,this.u12,this.u13,this.u23])}}class L{constructor(t,e,o=null,s=null,r=null){this.atom1Label=t,this.atom2Label=e,this.bondLength=o,this.bondLengthSU=s,this.atom2SiteSymmetry=r}static fromCIF(t,e){const o=t.get("_geom_bond");return new L(o.getIndex(["_geom_bond.atom_site_label_1","_geom_bond_atom_site_label_1"],e),o.getIndex(["_geom_bond.atom_site_label_2","_geom_bond_atom_site_label_2"],e),o.getIndex(["_geom_bond.distance","_geom_bond_distance"],e),o.getIndex(["_geom_bond.distance_su","_geom_bond_distance_su"],e,NaN),o.getIndex(["_geom_bond.site_symmetry_2","_geom_bond_site_symmetry_2"],e,"."))}}class N{constructor(t,e,o,s,r,a,i,d,n,f,h,b){this.donorAtomLabel=t,this.hydrogenAtomLabel=e,this.acceptorAtomLabel=o,this.donorHydrogenDistance=s,this.donorHydrogenDistanceSU=r,this.acceptorHydrogenDistance=a,this.acceptorHydrogenDistanceSU=i,this.donorAcceptorDistance=d,this.donorAcceptorDistanceSU=n,this.hBondAngle=f,this.hBondAngleSU=h,this.acceptorAtomSymmetry=b}static fromCIF(t,e){const o=t.get("_geom_hbond");return new N(o.getIndex(["_geom_hbond.atom_site_label_d","_geom_hbond_atom_site_label_D"],e),o.getIndex(["_geom_hbond.atom_site_label_h","_geom_hbond_atom_site_label_H"],e),o.getIndex(["_geom_hbond.atom_site_label_a","_geom_hbond_atom_site_label_A"],e),o.getIndex(["_geom_hbond.distance_dh","_geom_hbond_distance_DH"],e),o.getIndex(["_geom_hbond.distance_dh_su","_geom_hbond_distance_DH_su"],e,NaN),o.getIndex(["_geom_hbond.distance_ha","_geom_hbond_distance_HA"],e),o.getIndex(["_geom_hbond.distance_ha_su","_geom_hbond_distance_HA_su"],e,NaN),o.getIndex(["_geom_hbond.distance_da","_geom_hbond_distance_DA"],e),o.getIndex(["_geom_hbond.distance_da_su","_geom_hbond_distance_DA_su"],e,NaN),o.getIndex(["_geom_hbond.angle_dha","_geom_hbond_angle_DHA"],e),o.getIndex(["_geom_hbond.angle_dha_su","_geom_hbond_angle_DHA_su"],e,NaN),o.getIndex(["_geom_hbond.site_symmetry_a","_geom_hbond_site_symmetry_A"],e,"."))}}const m={camera:{minDistance:1,maxDistance:100,zoomSpeed:.1,initialPosition:[0,0,10],fov:45,near:.1,far:1e3},selection:{mode:"multiple",markerMult:1.3,bondMarkerMult:1.7,markerSegments:32,highlightEmissive:11184810,markerColors:[13323581,4895071,7956437,8238390,12671671,13738548,7768263,13854502,4566940,13976426,7050587,12542866,9408315,12741484,12156240]},interaction:{rotationSpeed:5,clickThreshold:200},hydrogenMode:"none",disorderMode:"all",symmetryMode:"bonds-no-hbonds-no",atomDetail:3,atomColorRoughness:.3,atomColorMetalness:.5,atomADPRingWidthFactor:1,atomADPRingHeight:.06,atomADPRingSections:18,atomADPInnerSections:7,bondRadius:.05,bondSections:15,bondColor:"#666666",bondColorRoughness:.3,bondColorMetalness:.1,hbondRadius:.04,hbondColor:"#AAAAAA",hbondColorRoughness:.3,hbondColorMetalness:.1,hbondDashSegmentLength:.3,hbondDashFraction:.6,elementProperties:{H:{radius:.31,atomColor:"#ffffff",ringColor:"#000000"},He:{radius:.28,atomColor:"#d9ffff",ringColor:"#000000"},Li:{radius:1.28,atomColor:"#cc80ff",ringColor:"#000000"},Be:{radius:.96,atomColor:"#c2ff00",ringColor:"#000000"},B:{radius:.85,atomColor:"#ffb5b5",ringColor:"#000000"},C:{radius:.76,atomColor:"#000000",ringColor:"#ffffff"},N:{radius:.71,atomColor:"#3050f8",ringColor:"#ffffff"},O:{radius:.66,atomColor:"#ff0d0d",ringColor:"#ffffff"},F:{radius:.57,atomColor:"#90e050",ringColor:"#000000"},Ne:{radius:.58,atomColor:"#b3e3f5",ringColor:"#000000"},Na:{radius:1.66,atomColor:"#ab5cf2",ringColor:"#ffffff"},Mg:{radius:1.41,atomColor:"#8aff00",ringColor:"#000000"},Al:{radius:1.21,atomColor:"#bfa6a6",ringColor:"#000000"},Si:{radius:1.11,atomColor:"#f0c8a0",ringColor:"#000000"},P:{radius:1.07,atomColor:"#ff8000",ringColor:"#000000"},S:{radius:1.05,atomColor:"#ffff30",ringColor:"#000000"},Cl:{radius:1.02,atomColor:"#1ff01f",ringColor:"#000000"},Ar:{radius:1.06,atomColor:"#80d1e3",ringColor:"#000000"},K:{radius:2.03,atomColor:"#8f40d4",ringColor:"#ffffff"},Ca:{radius:1.76,atomColor:"#3dff00",ringColor:"#000000"},Sc:{radius:1.7,atomColor:"#e6e6e6",ringColor:"#000000"},Ti:{radius:1.6,atomColor:"#bfc2c7",ringColor:"#000000"},V:{radius:1.53,atomColor:"#a6a6ab",ringColor:"#000000"},Cr:{radius:1.39,atomColor:"#8a99c7",ringColor:"#000000"},Mn:{radius:1.39,atomColor:"#9c7ac7",ringColor:"#000000"},Fe:{radius:1.32,atomColor:"#e06633",ringColor:"#ffffff"},Co:{radius:1.26,atomColor:"#f090a0",ringColor:"#000000"},Ni:{radius:1.24,atomColor:"#50d050",ringColor:"#000000"},Cu:{radius:1.32,atomColor:"#c88033",ringColor:"#000000"},Zn:{radius:1.22,atomColor:"#7d80b0",ringColor:"#000000"},Ga:{radius:1.22,atomColor:"#c28f8f",ringColor:"#000000"},Ge:{radius:1.2,atomColor:"#668f8f",ringColor:"#000000"},As:{radius:1.19,atomColor:"#bd80e3",ringColor:"#000000"},Se:{radius:1.2,atomColor:"#ffa100",ringColor:"#000000"},Br:{radius:1.2,atomColor:"#a62929",ringColor:"#ffffff"},Kr:{radius:1.16,atomColor:"#5cb8d1",ringColor:"#000000"},Rb:{radius:2.2,atomColor:"#702eb0",ringColor:"#ffffff"},Sr:{radius:1.95,atomColor:"#00ff00",ringColor:"#000000"},Y:{radius:1.9,atomColor:"#94ffff",ringColor:"#000000"},Zr:{radius:1.75,atomColor:"#94e0e0",ringColor:"#000000"},Nb:{radius:1.64,atomColor:"#73c2c9",ringColor:"#000000"},Mo:{radius:1.54,atomColor:"#54b5b5",ringColor:"#000000"},Tc:{radius:1.47,atomColor:"#3b9e9e",ringColor:"#000000"},Ru:{radius:1.46,atomColor:"#248f8f",ringColor:"#000000"},Rh:{radius:1.42,atomColor:"#0a7d8c",ringColor:"#000000"},Pd:{radius:1.39,atomColor:"#006985",ringColor:"#ffffff"},Ag:{radius:1.45,atomColor:"#c0c0c0",ringColor:"#000000"},Cd:{radius:1.44,atomColor:"#ffd98f",ringColor:"#000000"},In:{radius:1.42,atomColor:"#a67573",ringColor:"#000000"},Sn:{radius:1.39,atomColor:"#668080",ringColor:"#000000"},Sb:{radius:1.39,atomColor:"#9e63b5",ringColor:"#ffffff"},Te:{radius:1.38,atomColor:"#d47a00",ringColor:"#000000"},I:{radius:1.39,atomColor:"#940094",ringColor:"#ffffff"},Xe:{radius:1.4,atomColor:"#429eb0",ringColor:"#000000"},Cs:{radius:2.44,atomColor:"#57178f",ringColor:"#ffffff"},Ba:{radius:2.15,atomColor:"#00c900",ringColor:"#000000"},La:{radius:2.07,atomColor:"#70d4ff",ringColor:"#000000"},Ce:{radius:2.04,atomColor:"#ffffc7",ringColor:"#000000"},Pr:{radius:2.03,atomColor:"#d9ffc7",ringColor:"#000000"},Nd:{radius:2.01,atomColor:"#c7ffc7",ringColor:"#000000"},Pm:{radius:1.99,atomColor:"#a3ffc7",ringColor:"#000000"},Sm:{radius:1.98,atomColor:"#8fffc7",ringColor:"#000000"},Eu:{radius:1.98,atomColor:"#61ffc7",ringColor:"#000000"},Gd:{radius:1.96,atomColor:"#45ffc7",ringColor:"#000000"},Tb:{radius:1.94,atomColor:"#30ffc7",ringColor:"#000000"},Dy:{radius:1.92,atomColor:"#1fffc7",ringColor:"#000000"},Ho:{radius:1.92,atomColor:"#00ff9c",ringColor:"#000000"},Er:{radius:1.89,atomColor:"#00e675",ringColor:"#000000"},Tm:{radius:1.9,atomColor:"#00d452",ringColor:"#000000"},Yb:{radius:1.87,atomColor:"#00bf38",ringColor:"#000000"},Lu:{radius:1.87,atomColor:"#00ab24",ringColor:"#000000"},Hf:{radius:1.75,atomColor:"#4dc2ff",ringColor:"#000000"},Ta:{radius:1.7,atomColor:"#4da6ff",ringColor:"#000000"},W:{radius:1.62,atomColor:"#2194d6",ringColor:"#000000"},Re:{radius:1.51,atomColor:"#267dab",ringColor:"#000000"},Os:{radius:1.44,atomColor:"#266696",ringColor:"#ffffff"},Ir:{radius:1.41,atomColor:"#175487",ringColor:"#ffffff"},Pt:{radius:1.36,atomColor:"#d0d0e0",ringColor:"#000000"},Au:{radius:1.36,atomColor:"#ffd123",ringColor:"#000000"},Hg:{radius:1.32,atomColor:"#b8b8d0",ringColor:"#000000"},Tl:{radius:1.45,atomColor:"#a6544d",ringColor:"#ffffff"},Pb:{radius:1.46,atomColor:"#575961",ringColor:"#ffffff"},Bi:{radius:1.48,atomColor:"#9e4fb5",ringColor:"#ffffff"},Po:{radius:1.4,atomColor:"#ab5c00",ringColor:"#ffffff"},At:{radius:1.5,atomColor:"#754f45",ringColor:"#ffffff"},Rn:{radius:1.5,atomColor:"#428296",ringColor:"#000000"},Fr:{radius:2.6,atomColor:"#420066",ringColor:"#ffffff"},Ra:{radius:2.21,atomColor:"#007d00",ringColor:"#000000"},Ac:{radius:2.15,atomColor:"#70abfa",ringColor:"#000000"},Th:{radius:2.06,atomColor:"#00baff",ringColor:"#000000"},Pa:{radius:2,atomColor:"#00a1ff",ringColor:"#000000"},U:{radius:1.96,atomColor:"#008fff",ringColor:"#000000"},Np:{radius:1.9,atomColor:"#0080ff",ringColor:"#000000"},Pu:{radius:1.87,atomColor:"#006bff",ringColor:"#ffffff"},Am:{radius:1.8,atomColor:"#545cf2",ringColor:"#ffffff"},Cm:{radius:1.69,atomColor:"#785ce3",ringColor:"#ffffff"}}};class I{constructor(t,e,o,s=[]){if(new.target===I)throw new TypeError("Cannot instantiate BaseFilter directly");this.MODES=Object.freeze(t),this.PREFERRED_FALLBACK_ORDER=Object.freeze(s),this.filterName=o,this._mode=null,this.setMode(e)}get mode(){return this._mode}set mode(t){this.setMode(t)}setMode(t){const e=t.toLowerCase().replace(/_/g,"-"),o=Object.values(this.MODES);if(!o.includes(e))throw new Error(`Invalid ${this.filterName} mode: "${t}". Valid modes are: ${o.join(", ")}`);this._mode=e}ensureValidMode(t){const e=this.getApplicableModes(t);if(!e.includes(this.mode)){const o=this.mode;this.mode=this.PREFERRED_FALLBACK_ORDER.find(s=>e.includes(s))||e[0],console.warn(`${this.filterName} mode ${o} was not applicable, chaged to ${this.mode}`)}}apply(t){throw new Error('Method "apply" must be implemented by subclass')}getApplicableModes(t){throw new Error('Method "getApplicableModes" must be implemented by subclass')}cycleMode(t){const e=this.getApplicableModes(t);this.ensureValidMode(t);const o=e.indexOf(this._mode);return this._mode=e[(o+1)%e.length],this._mode}}const _=class _ extends I{constructor(t=_.MODES.NONE){super(_.MODES,t,"HydrogenFilter",_.PREFERRED_FALLBACK_ORDER)}apply(t){this.ensureValidMode(t);const e=t.atoms.filter(r=>r.atomType!=="H"||this.mode!==_.MODES.NONE).map(r=>new z(r.label,r.atomType,r.position,r.atomType==="H"&&this.mode===_.MODES.CONSTANT?null:r.adp,r.disorderGroup)),o=t.bonds.filter(r=>{if(this.mode===_.MODES.NONE){const a=t.getAtomByLabel(r.atom1Label),i=t.getAtomByLabel(r.atom2Label);return!(a.atomType==="H"||i.atomType==="H")}return!0}),s=this.mode===_.MODES.NONE?[]:t.hBonds;return new O(t.cell,e,o,s,t.symmetry)}getApplicableModes(t){const e=[_.MODES.NONE];return t.atoms.some(r=>r.atomType==="H")&&(e.push(_.MODES.CONSTANT),t.atoms.some(r=>{var a;return r.atomType==="H"&&((a=r.adp)==null?void 0:a.constructor.name)==="UAnisoADP"})&&e.push(_.MODES.ANISOTROPIC)),e}};E(_,"MODES",Object.freeze({NONE:"none",CONSTANT:"constant",ANISOTROPIC:"anisotropic"})),E(_,"PREFERRED_FALLBACK_ORDER",[_.MODES.ANISOTROPIC,_.MODES.CONSTANT,_.MODES.NONE]);let X=_;const k=class k extends I{constructor(t=k.MODES.ALL){super(k.MODES,t,"DisorderFilter",k.PREFERRED_FALLBACK_ORDER)}apply(t){this.ensureValidMode(t);const e=t.atoms.filter(r=>!(this.mode===k.MODES.GROUP1&&r.disorderGroup>1||this.mode===k.MODES.GROUP2&&r.disorderGroup===1)),o=t.bonds.filter(r=>{const a=t.getAtomByLabel(r.atom1Label),i=t.getAtomByLabel(r.atom2Label);return!(this.mode===k.MODES.GROUP1&&(a.disorderGroup>1||i.disorderGroup>1)||this.mode===k.MODES.GROUP2&&(a.disorderGroup===1||i.disorderGroup===1))}),s=t.hBonds.filter(r=>{const a=t.getAtomByLabel(r.donorAtomLabel),i=t.getAtomByLabel(r.hydrogenAtomLabel),d=t.getAtomByLabel(r.acceptorAtomLabel);return!(this.mode===k.MODES.GROUP1&&(a.disorderGroup>1||i.disorderGroup>1||d.disorderGroup>1)||this.mode===k.MODES.GROUP2&&(a.disorderGroup===1||i.disorderGroup===1||d.disorderGroup===1))});return new O(t.cell,e,o,s,t.symmetry)}getApplicableModes(t){const e=[k.MODES.ALL];return t.atoms.some(s=>s.disorderGroup>0)&&(t.atoms.some(s=>s.disorderGroup===1)&&e.push(k.MODES.GROUP1),t.atoms.some(s=>s.disorderGroup>1)&&e.push(k.MODES.GROUP2)),e}};E(k,"MODES",Object.freeze({ALL:"all",GROUP1:"group1",GROUP2:"group2"})),E(k,"PREFERRED_FALLBACK_ORDER",[k.MODES.ALL,k.MODES.GROUP1,k.MODES.GROUP2]);let K=k;const u=class u extends I{constructor(t=u.MODES.BONDS_NO_HBONDS_NO){super(u.MODES,t,"SymmetryGrower",u.PREFERRED_FALLBACK_ORDER)}static combineSymOpLabel(t,e){return!e||e==="."?t:`${t}@${e}`}findGrowableAtoms(t){const e=t.bonds.filter(({atom2SiteSymmetry:s})=>s&&s!==".").map(({atom2Label:s,atom2SiteSymmetry:r})=>[s,r]),o=t.hBonds.filter(({acceptorAtomSymmetry:s})=>s&&s!==".").map(({acceptorAtomLabel:s,acceptorAtomSymmetry:r})=>[s,r]);return{bondAtoms:e,hBondAtoms:o}}growAtomArray(t,e,o){for(const[s,r]of e){const a=u.combineSymOpLabel(s,r);if(o.labels.has(a))continue;const i=t.connectedGroups.find(n=>n.atoms.some(f=>f.label===s));if(!i)throw new Error(`Atom ${s} is not in any group. Typo or structure.recalculateConnectedGroups()?`);t.symmetry.applySymmetry(r,i.atoms).forEach(n=>{n.label=u.combineSymOpLabel(n.label,r),o.labels.add(n.label),o.atoms.add(n)}),i.bonds.filter(({atom2SiteSymmetry:n})=>n===".").forEach(n=>{o.bonds.add(new L(u.combineSymOpLabel(n.atom1Label,r),u.combineSymOpLabel(n.atom2Label,r),n.bondLength,n.bondLengthSU,"."))}),i.hBonds.filter(({acceptorAtomSymmetry:n})=>n===".").forEach(n=>{o.hBonds.add(new N(u.combineSymOpLabel(n.donorAtomLabel,r),u.combineSymOpLabel(n.hydrogenAtomLabel,r),u.combineSymOpLabel(n.acceptorAtomLabel,r),n.donorHydrogenDistance,n.donorHydrogenDistanceSU,n.acceptorHydrogenDistance,n.acceptorHydrogenDistanceSU,n.donorAcceptorDistance,n.donorAcceptorDistanceSU,n.hBondAngle,n.hBondAngleSU,"."))})}return o}apply(t){this.ensureValidMode(t);const e=this.findGrowableAtoms(t),o={atoms:new Set(t.atoms),bonds:new Set(t.bonds),hBonds:new Set(t.hBonds),labels:new Set(t.atoms.map(({label:a})=>a))};this.mode.startsWith("bonds-yes")&&this.growAtomArray(t,e.bondAtoms,o),this.mode.includes("hbonds-yes")&&this.growAtomArray(t,e.hBondAtoms,o);const s=Array.from(o.atoms);for(const a of t.bonds){if(a.atom2SiteSymmetry===".")continue;const i=u.combineSymOpLabel(a.atom2Label,a.atom2SiteSymmetry);s.some(d=>d.label===i)&&o.bonds.add(new L(a.atom1Label,i,a.bondLength,a.bondLengthSU,"."))}for(const a of t.hBonds){if(a.acceptorAtomSymmetry===".")continue;const i=u.combineSymOpLabel(a.acceptorAtomLabel,a.acceptorAtomSymmetry);s.some(d=>d.label===i)&&o.hBonds.add(new N(a.donorAtomLabel,a.hydrogenAtomLabel,i,a.donorHydrogenDistance,a.donorHydrogenDistanceSU,a.acceptorHydrogenDistance,a.acceptorHydrogenDistanceSU,a.donorAcceptorDistance,a.donorAcceptorDistanceSU,a.hBondAngle,a.hBondAngleSU,"."))}const r=Array.from(o.hBonds).filter(({acceptorAtomLabel:a,hydrogenAtomLabel:i,donorAtomLabel:d})=>{const n=o.labels.has(a),f=o.labels.has(i),h=o.labels.has(d);return n&&f&&h});return new O(t.cell,s,Array.from(o.bonds),r,t.symmetry)}getApplicableModes(t){const e=this.findGrowableAtoms(t),o=e.bondAtoms.length>0,s=e.hBondAtoms.length>0;return!o&&!s?[u.MODES.BONDS_NONE_HBONDS_NONE]:o?s?[u.MODES.BONDS_YES_HBONDS_YES,u.MODES.BONDS_YES_HBONDS_NO,u.MODES.BONDS_NO_HBONDS_YES,u.MODES.BONDS_NO_HBONDS_NO]:[u.MODES.BONDS_YES_HBONDS_NONE,u.MODES.BONDS_NO_HBONDS_NONE]:[u.MODES.BONDS_NONE_HBONDS_YES,u.MODES.BONDS_NONE_HBONDS_NO]}};E(u,"MODES",Object.freeze({BONDS_YES_HBONDS_YES:"bonds-yes-hbonds-yes",BONDS_YES_HBONDS_NO:"bonds-yes-hbonds-no",BONDS_YES_HBONDS_NONE:"bonds-yes-hbonds-none",BONDS_NO_HBONDS_YES:"bonds-no-hbonds-yes",BONDS_NO_HBONDS_NO:"bonds-no-hbonds-no",BONDS_NO_HBONDS_NONE:"bonds-no-hbonds-none",BONDS_NONE_HBONDS_YES:"bonds-none-hbonds-yes",BONDS_NONE_HBONDS_NO:"bonds-none-hbonds-no",BONDS_NONE_HBONDS_NONE:"bonds-none-hbonds-none"})),E(u,"PREFERRED_FALLBACK_ORDER",[u.MODES.BONDS_NO_HBONDS_NO,u.MODES.BONDS_NO_HBONDS_NONE,u.MODES.BONDS_NONE_HBONDS_NO]);let P=u;const kt={},v=y.create(y.all,kt);function _t(l){if(l.length!==6)throw new Error("This function needs six cartesian Uij parameters.");const t=st(l),{values:e,eigenvectors:o}=v.eigs(t);o.reverse();const s=v.transpose(v.matrix(o.map(h=>h.vector))),r=v.matrix(o.map(h=>h.value)),a=v.det(s),i=v.diag(r.map(Math.sqrt));let d;if(v.abs(a-1)>1e-10){const h=v.multiply(s,1/a);d=v.multiply(h,i)}else d=v.multiply(s,i);const n=v.matrix(d).toArray();v.diag(v.matrix(d.toArray().map(h=>v.norm(h))));const f=new c.Matrix4;return f.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),f}function it(l,t){const e=t.clone().sub(l),o=e.length(),s=e.divideScalar(o),r=new c.Vector3(0,1,0),a=new c.Vector3().crossVectors(s,r),i=-Math.acos(s.dot(r));return new c.Matrix4().makeScale(1,o,1).premultiply(new c.Matrix4().makeRotationAxis(a.normalize(),i)).setPosition(l.clone().add(t).multiplyScalar(.5))}class nt{constructor(t,e={}){this.options={atomDetail:m.atomDetail,atomColorRoughness:m.atomColorRoughness,atomColorMetalness:m.atomColorMetalness,atomADPRingWidthFactor:m.atomADPRingWidthFactor,atomADPRingHeight:m.atomADPRingHeight,atomADPRingSections:m.atomADPRingSections,bondRadius:m.bondRadius,bondSections:m.bondSections,bondColor:m.bondColor,bondColorRoughness:m.bondColorRoughness,bondColorMetalness:m.bondColorMetalness,hbondRadius:m.hbondRadius,hbondColor:m.hbondColor,hbondColorRoughness:m.hbondColorRoughness,hbondColorMetalness:m.hbondColorMetalness,hbondDashSegmentLength:m.hbondDashSegmentLength,hbondDashFraction:m.hbondDashFraction,elementProperties:{...m.elementProperties,...e.elementProperties},...e},this.crystalStructure=t,this.scaling=1.5384,this.createBaseGeometries(),this.createBaseMaterials(),this.colorMaterials={},this.atoms3D=[];const o=this.crystalStructure.atoms.map(a=>a.label);for(const a of this.crystalStructure.atoms){const[i,d]=this.getAtomMaterials(a.atomType);a.adp instanceof $?this.atoms3D.push(new Ct(a,this.crystalStructure.cell,this.baseAtom,i,this.baseADPRing,d)):this.atoms3D.push(new Dt(a,this.crystalStructure.cell,this.baseAtom,i))}const s=this.crystalStructure.bonds.map(a=>new L(a.atom1Label,P.combineSymOpLabel(a.atom2Label,a.atom2SiteSymmetry),a.bondLength,a.bondLengthSU,".")).filter(a=>o.includes(a.atom2Label));this.bonds3D=[];for(const a of s)this.bonds3D.push(new vt(a,this.crystalStructure,this.baseBond,this.baseBondMaterial));const r=this.crystalStructure.hBonds.map(a=>new N(a.donorAtomLabel,a.hydrogenAtomLabel,P.combineSymOpLabel(a.acceptorAtomLabel,a.acceptorAtomSymmetry),a.donorHydrogenDistance,a.donorHydrogenDistanceSU,a.acceptorHydrogenDistance,a.acceptorHydrogenDistanceSU,a.donorAcceptorDistance,a.donorAcceptorDistanceSU,a.hBondAngle,a.hBondAngleSU,".")).filter(a=>o.includes(a.acceptorAtomLabel));this.hBonds3D=[];for(const a of r)this.hBonds3D.push(new St(a,this.crystalStructure,this.baseHBond,this.baseHBondMaterial,this.options.hbondDashSegmentLength,this.options.hbondDashFraction))}createBaseGeometries(){this.baseAtom=new c.IcosahedronGeometry(this.scaling,this.options.atomDetail),this.baseADPRing=this.getADPHalfTorus(),this.baseBond=new c.CylinderGeometry(this.options.bondRadius,this.options.bondRadius,.98,this.options.bondSections,1,!0),this.baseHBond=new c.CylinderGeometry(this.options.hbondRadius,this.options.hbondRadius,.98,this.options.bondSections,1,!0)}createBaseMaterials(){this.baseBondMaterial=new c.MeshStandardMaterial({color:this.options.bondColor,roughness:this.options.bondColorRoughness,metalness:this.options.bondColorMetalness}),this.baseHBondMaterial=new c.MeshStandardMaterial({color:this.options.hbondColor,roughness:this.options.hbondColorRoughness,metalness:this.options.hbondColorMetalness})}getADPHalfTorus(){const t=new c.TorusGeometry(this.scaling*this.options.atomADPRingWidthFactor,this.options.atomADPRingHeight,this.options.atomADPInnerSections,this.options.atomADPRingSections),e=t.attributes.position.array,o=t.index.array,s=[],r=[],a=new Set;for(let f=0;f<o.length;f+=3){const h=o[f]*3,b=o[f+1]*3,D=o[f+2]*3,x=Math.sqrt(e[h]*e[h]+e[h+1]*e[h+1]+e[h+2]*e[h+2]),H=Math.sqrt(e[b]*e[b]+e[b+1]*e[b+1]+e[b+2]*e[b+2]),F=Math.sqrt(e[D]*e[D]+e[D+1]*e[D+1]+e[D+2]*e[D+2]);x>=this.scaling&&H>=this.scaling&&F>=this.scaling&&(a.add(o[f]),a.add(o[f+1]),a.add(o[f+2]))}const i=new Map;let d=0;a.forEach(f=>{const h=f*3;s.push(e[h],e[h+1],e[h+2]),i.set(f,d++)});for(let f=0;f<o.length;f+=3)a.has(o[f])&&a.has(o[f+1])&&a.has(o[f+2])&&r.push(i.get(o[f]),i.get(o[f+1]),i.get(o[f+2]));const n=new c.BufferGeometry;return n.setAttribute("position",new c.Float32BufferAttribute(s,3)),n.setIndex(r),n.computeVertexNormals(),n.rotateX(.5*Math.PI),n}getAtomMaterials(t){const e=this.options.elementProperties[t];for(const r of[e.atomColor,e.ringColor])if(!(r in this.colorMaterials)){const a=new c.MeshStandardMaterial({color:r,roughness:this.options.atomColorRoughness,metalness:this.options.atomColorMetalness});this.colorMaterials[r]=a}const o=this.colorMaterials[e.atomColor],s=this.colorMaterials[e.ringColor];return[o,s]}getGroup(){const t=new c.Group;let e=new c.Vector3;for(const o of this.atoms3D)t.add(o.object3D),e.add(o.object3D.position);for(const o of this.bonds3D)t.add(o.object3D);for(const o of this.hBonds3D)t.add(o.object3D);return e.divideScalar(-this.atoms3D.length),t.position.copy(e),t}}class Z{createSelectionMarker(t,e){}}class lt extends Z{constructor(t,e,o,s){super(),this.atom=t;const r=new c.Vector3(...t.position.toCartesian(e));this.object3D=new c.Mesh(o,s),this.object3D.position.copy(r),this.object3D.userData.type="atom",this.object3D.userData.atomData=t}createSelectionMarker(t,e){const o=new c.Mesh(this.object3D.geometry,new c.MeshBasicMaterial({color:t,transparent:!0,opacity:.9,side:c.BackSide}));return o.scale.multiplyScalar(e.selection.markerMult),o.userData.selectable=!1,o}}class Ct extends lt{constructor(t,e,o,s,r=null,a=null){super(t,e,o,s);const i=new c.Vector3(...t.position.toCartesian(e)),d=_t(t.adp.getUCart(e));if(d.toArray().includes(NaN))this.object3D=new c.Mesh(new c.TetrahedronGeometry(1),s);else{this.object3D=new c.Mesh(o,s);for(const n of this.adpRingMatrices){const f=new c.Mesh(r,a);f.applyMatrix4(n),f.userData.selectable=!1,this.object3D.add(f)}this.object3D.applyMatrix4(d)}this.object3D.position.copy(i),this.object3D.userData.type="atom",this.object3D.userData.atomData=t,this.object3D.userData.selectable=!0}get adpRingMatrices(){const t=new c.Matrix4;t.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);const e=new c.Matrix4;e.set(1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1);const o=new c.Matrix4;return o.set(0,-1,0,0,1,0,0,0,0,0,1,0,0,0,0,1),[t,e,o]}}class Dt extends lt{constructor(t,e,o,s){super(t,e,o,s),this.object3D.scale.multiplyScalar(1/10.53),this.object3D.userData.type="atom",this.object3D.userData.atomData=t,this.object3D.userData.selectable=!0}}class vt extends Z{constructor(t,e,o,s){super();const r=e.getAtomByLabel(t.atom1Label),a=e.getAtomByLabel(t.atom2Label),i=new c.Vector3(...r.position.toCartesian(e.cell)),d=new c.Vector3(...a.position.toCartesian(e.cell)),n=it(i,d);this.object3D=new c.Mesh(o,s),this.object3D.applyMatrix4(n),this.object3D.userData.type="bond",this.object3D.userData.bondData=t,this.object3D.userData.selectable=!0}createSelectionMarker(t,e){const o=new c.Mesh(this.object3D.geometry,new c.MeshBasicMaterial({color:t,transparent:!0,opacity:.9,side:c.BackSide}));return o.scale.x*=e.selection.bondMarkerMult,o.scale.z*=e.selection.bondMarkerMult,o.userData.selectable=!1,o}}class j extends c.Group{constructor(){super(),this._material=null}get material(){return this.children[0].material.clone()}set material(t){this._material=t,this.traverse(e=>{e instanceof c.Mesh&&(e.material=t)})}dispose(){this._material&&this._material.dispose(),this.traverse(t=>{t instanceof c.Mesh&&t.geometry&&t.geometry.dispose()})}clone(t=!0){const e=new j;return e.copy(this,t),e._material=this._material,e}copy(t,e=!0){return super.copy(t,e),this._material=t._material,this}}class St extends Z{constructor(t,e,o,s,r,a){super(),this.baseHBond=o;const i=e.getAtomByLabel(t.hydrogenAtomLabel),d=new c.Vector3(...i.position.toCartesian(e.cell)),n=e.getAtomByLabel(t.acceptorAtomLabel),f=new c.Vector3(...n.position.toCartesian(e.cell));this.object3D=new j;const h=d.distanceTo(f),b=Math.floor(h/r),D=Math.max(1,b),H=h/D*a;this.hydrogenPosition=d,this.acceptorPosition=f;for(let F=0;F<D;F++){const ft=F/D,Lt=ft+H/h,Nt=new c.Vector3().lerpVectors(d,f,ft),Bt=new c.Vector3().lerpVectors(d,f,Lt),B=new c.Mesh(o),Tt=it(Nt,Bt);B.applyMatrix4(Tt),B.userData.type="hbond_segment",B.userData.hbondData=t,B.userData.selectable=!0,B.userData.parentGroup=this.object3D,this.object3D.add(B)}this.object3D.material=s,this.object3D.userData.type="hbond",this.object3D.userData.hbondData=t,this.object3D.userData.selectable=!0}createSelectionMarker(t,e){const o=new j,s=new c.MeshBasicMaterial({color:t,transparent:!0,opacity:.9,side:c.BackSide});return this.object3D.children.forEach(r=>{const a=new c.Mesh(r.geometry,s);a.applyMatrix4(r.matrix),a.scale.x*=e.selection.bondMarkerMult,a.scale.y*=.8*e.selection.bondMarkerMult,a.scale.z*=e.selection.bondMarkerMult,a.userData.selectable=!1,o.add(a)}),o}}function xt(l){const t=new c.Box3;t.setFromObject(l);const e=new c.Vector3;t.getSize(e);const o=new c.Vector3;return t.getCenter(o),{boundingBox:t,size:e,center:o}}function Mt(l,t){l.children=l.children.filter(n=>!(n instanceof c.Light));const{size:e,center:o}=t,r=Math.max(e.x,e.y,e.z),a=new c.AmbientLight(16777215,1);l.add(a);const i=new c.SpotLight(16777215,1e3,0,Math.PI*.27,.6);i.position.set(0,-.5,4*r),i.lookAt(new c.Vector3(0,0,0)),l.add(i),[{pos:[-1,-.5,1],intensity:.4},{pos:[1,-.5,1],intensity:.4},{pos:[0,-.5,1],intensity:.3}].forEach(({pos:n,intensity:f})=>{const h=new c.DirectionalLight(16777215,f);h.position.set(n[0]*r,n[1]*r,n[2]*r),l.add(h)})}class At{constructor(t,e={}){this.viewer=t,this.container=t.container,this.camera=t.camera,this.renderer=t.renderer,this.moleculeContainer=t.moleculeContainer,this.raycaster=t.raycaster,this.options=t.options,this.doubleClickDelay=300,this.state={isDragging:!1,mouse:new c.Vector2,lastClickTime:0,clickStartTime:0,pinchStartDistance:0,lastTouchRotation:0},this.setupEventListeners()}setupEventListeners(){const t=this.renderer.domElement;t.addEventListener("wheel",this.handleWheel.bind(this)),t.addEventListener("mousedown",this.handleMouseDown.bind(this)),t.addEventListener("mousemove",this.handleMouseMove.bind(this)),t.addEventListener("mouseup",this.handleMouseUp.bind(this)),t.addEventListener("mouseleave",this.handleMouseUp.bind(this)),t.addEventListener("click",this.handleClick.bind(this)),t.addEventListener("touchstart",this.handleTouchStart.bind(this)),t.addEventListener("touchmove",this.handleTouchMove.bind(this)),t.addEventListener("touchend",this.handleTouchEnd.bind(this)),window.addEventListener("resize",this.handleResize.bind(this))}updateMouseCoordinates(t,e){const o=this.container.getBoundingClientRect();this.state.mouse.set((t-o.left)/o.width*2-1,-((e-o.top)/o.height)*2+1)}handleTouchStart(t){if(t.preventDefault(),t.touches.length===1){this.state.isDragging=!0,this.state.clickStartTime=Date.now();const e=t.touches[0];this.updateMouseCoordinates(e.clientX,e.clientY)}else if(t.touches.length===2){this.state.isDragging=!1;const e=t.touches[0].clientX-t.touches[1].clientX,o=t.touches[0].clientY-t.touches[1].clientY;this.state.pinchStartDistance=Math.sqrt(e*e+o*o),this.state.lastTouchRotation=Math.atan2(o,e)}}handleTouchMove(t){t.preventDefault();const e=this.container.getBoundingClientRect();if(t.touches.length===1&&this.state.isDragging){const o=t.touches[0],s=new c.Vector2((o.clientX-e.left)/e.width*2-1,-((o.clientY-e.top)/e.height)*2+1),r=s.clone().sub(this.state.mouse);this.rotateStructure(r),this.state.mouse.copy(s)}else if(t.touches.length===2){const o=t.touches[0].clientX-t.touches[1].clientX,s=t.touches[0].clientY-t.touches[1].clientY,r=Math.sqrt(o*o+s*s),a=(this.state.pinchStartDistance-r)*.01;this.handleZoom(a),this.state.pinchStartDistance=r;const i=Math.atan2(s,o),d=i-this.state.lastTouchRotation;this.moleculeContainer.rotateZ(d),this.state.lastTouchRotation=i}}handleTouchEnd(t){t.preventDefault(),t.touches.length===0&&(Date.now()-this.state.clickStartTime<this.options.interaction.clickThreshold&&!this.state.isDragging&&this.handleTap(t.changedTouches[0]),this.state.isDragging=!1)}handleTap(t){const e=Date.now(),o=e-this.state.lastClickTime;this.state.lastClickTime=e,this.updateMouseCoordinates(t.clientX,t.clientY),this.raycaster.setFromCamera(this.state.mouse,this.camera);const s=[];this.moleculeContainer.traverse(a=>{a instanceof c.Mesh&&a.userData.selectable===!0&&s.push(a)});const r=this.raycaster.intersectObjects(s).filter(a=>a.object.userData.selectable!==!1);if(r.length>0){let a=r[0].object;this.viewer.handleSelection(a)}else o<this.doubleClickDelay&&this.viewer.clearSelections()}rotateStructure(t){this.moleculeContainer.applyMatrix4(new c.Matrix4().makeRotationAxis(new c.Vector3(0,1,0),t.x*this.options.interaction.rotationSpeed)),this.moleculeContainer.applyMatrix4(new c.Matrix4().makeRotationAxis(new c.Vector3(1,0,0),-t.y*this.options.interaction.rotationSpeed))}handleZoom(t){const e=this.camera.position.distanceTo(this.viewer.cameraTarget),o=c.MathUtils.clamp(e+t,this.options.camera.minDistance,this.options.camera.maxDistance),s=this.camera.position.clone().sub(this.viewer.cameraTarget).normalize();this.camera.position.copy(s.multiplyScalar(o).add(this.viewer.cameraTarget)),this.camera.lookAt(this.viewer.cameraTarget)}handleResize(){const t=this.container.getBoundingClientRect();this.camera.aspect=t.width/t.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(t.width,t.height)}handleWheel(t){t.preventDefault(),this.handleZoom(t.deltaY*this.options.camera.zoomSpeed)}handleMouseMove(t){if(!this.state.isDragging)return;const e=new c.Vector2,o=this.container.getBoundingClientRect();e.set((t.clientX-o.left)/o.width*2-1,-((t.clientY-o.top)/o.height)*2+1);const s=e.clone().sub(this.state.mouse);this.rotateStructure(s),this.state.mouse.copy(e)}handleMouseDown(t){this.state.isDragging=!0,this.state.clickStartTime=Date.now(),this.updateMouseCoordinates(t.clientX,t.clientY)}handleMouseUp(){this.state.isDragging=!1}handleClick(t){if(Date.now()-this.state.clickStartTime>this.options.interaction.clickThreshold||this.state.isDragging)return;const o=Date.now(),s=o-this.state.lastClickTime;this.state.lastClickTime=o,this.updateMouseCoordinates(t.clientX,t.clientY),this.raycaster.setFromCamera(this.state.mouse,this.camera);const r=[];this.moleculeContainer.traverse(i=>{i instanceof c.Mesh&&i.userData.selectable===!0&&r.push(i)});const a=this.raycaster.intersectObjects(r).filter(i=>i.object.userData.selectable!==!1);if(a.length>0){let i=a[0].object;this.viewer.handleSelection(i)}else s<this.doubleClickDelay&&this.viewer.clearSelections()}dispose(){const t=this.renderer.domElement;t.removeEventListener("wheel",this.handleWheel),t.removeEventListener("mousedown",this.handleMouseDown),t.removeEventListener("mousemove",this.handleMouseMove),t.removeEventListener("mouseup",this.handleMouseUp),t.removeEventListener("mouseleave",this.handleMouseUp),t.removeEventListener("click",this.handleClick),t.removeEventListener("touchstart",this.handleTouchStart),t.removeEventListener("touchmove",this.handleTouchMove),t.removeEventListener("touchend",this.handleTouchEnd),window.removeEventListener("resize",this.handleResize)}}y.create(y.all);class dt{constructor(t,e={}){this.container=t,this.options={camera:{...m.camera,initialPosition:new c.Vector3(...m.camera.initialPosition),...e.camera||{}},selection:{...m.selection,...e.selection||{}},interaction:{...m.interaction,...e.interaction||{}},atomDetail:e.atomDetail||m.atomDetail,atomColorRoughness:e.atomColorRoughness||m.atomColorRoughness,atomColorMetalness:e.atomColorMetalness||m.atomColorMetalness,atomADPRingWidthFactor:e.atomADPRingWidthFactor||m.atomADPRingWidthFactor,atomADPRingHeight:e.atomADPRingHeight||m.atomADPRingHeight,atomADPRingSections:e.atomADPRingSections||m.atomADPRingSections,bondRadius:e.bondRadius||m.bondRadius,bondSections:e.bondSections||m.bondSections,bondColor:e.bondColor||m.bondColor,bondColorRoughness:e.bondColorRoughness||m.bondColorRoughness,bondColorMetalness:e.bondColorMetalness||m.bondColorMetalness,elementProperties:{...m.elementProperties,...e.elementProperties},hydrogenMode:e.hydrogenMode||m.hydrogenMode,disorderMode:e.disorderMode||m.disorderMode,symmetryMode:e.symmetryMode||m.symmetryMode},this.state={selectedObjects:new Set,isDragging:!1,currentCifContent:null,currentStructure:null,currentFloor:null,selectionCallbacks:new Set,baseStructure:null,ortepObjects:new Map},this.modifiers={hydrogen:new X(this.options.hydrogenMode),disorder:new K(this.options.disorderMode),symmetry:new P(this.options.symmetryMode)},this.setupScene(),this.controls=new At(this),this.animate()}setupScene(){this.scene=new c.Scene,this.camera=new c.PerspectiveCamera(this.options.camera.fov,this.container.clientWidth/this.container.clientHeight,this.options.camera.near,this.options.camera.far),this.renderer=new c.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.container.appendChild(this.renderer.domElement),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.moleculeContainer=new c.Group,this.scene.add(this.moleculeContainer),this.camera.position.copy(this.options.camera.initialPosition),this.cameraTarget=new c.Vector3(0,0,0),this.camera.lookAt(this.cameraTarget),this.raycaster=new c.Raycaster,this.raycaster.params.Line.threshold=.5,this.raycaster.params.Points.threshold=.5,this.raycaster.params.Mesh.threshold=.1,this.raycaster.near=.1,this.raycaster.far=100}async loadStructure(t=null){try{if(this.clearScene(),t){this.state.currentCifContent=t;const s=new et(t,!0);this.state.baseStructure=O.fromCIF(s.getBlock(0))}const e=this.applyFilters(),o=xt(e);return this.updateCameraBounds(o),Mt(this.scene,o),{success:!0}}catch(e){return console.error("Error loading structure:",e),{success:!1,error:e.message}}}applyFilters(){let t=this.state.baseStructure;for(const s of Object.values(this.modifiers))t=s.apply(t);const e=new nt(t,this.options);this.state.ortepObjects=new Map,e.atoms3D.forEach(s=>this.state.ortepObjects.set(s.object3D,s)),e.bonds3D.forEach(s=>this.state.ortepObjects.set(s.object3D,s)),e.hBonds3D.forEach(s=>this.state.ortepObjects.set(s.object3D,s));const o=e.getGroup();return this.setupStructureObjects(o),this.moleculeContainer.add(o),this.state.currentStructure=o,o}clearScene(){this.moleculeContainer.clear(),this.state.selectedObjects.clear(),this.state.currentFloor&&this.scene.remove(this.state.currentFloor)}setupStructureObjects(t){t.traverse(e=>{e instanceof c.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)})}updateCameraBounds(t){const e=Math.max(t.size.x,t.size.y,t.size.z);this.options.camera.minDistance=e*.5,this.options.camera.maxDistance=e*5;const o=e*2;this.camera.position.set(0,0,o),this.camera.rotation.set(0,0,0),this.camera.lookAt(this.cameraTarget)}async cycleHydrogenMode(){const t=this.modifiers.hydrogen.cycleMode(this.state.baseStructure);return{...await this.loadStructure(),mode:t}}async cycleDisorderMode(){const t=this.modifiers.disorder.cycleMode(this.state.baseStructure);return{...await this.loadStructure(),mode:t}}async cycleSymmetryMode(){const t=this.modifiers.symmetry.cycleMode(this.state.baseStructure);return{...await this.loadStructure(),mode:t}}hasDisorderGroups(){return this.state.baseStructure?this.modifiers.disorder.getApplicableModes(this.state.baseStructure).length>1:!1}animate(){requestAnimationFrame(this.animate.bind(this)),this.renderer.render(this.scene,this.camera)}handleSelection(t){t.userData.type==="hbond_segment"&&(t=t.userData.parentGroup),this.options.selection.mode==="single"&&(this.state.selectedObjects.forEach(o=>{this.removeSelection(o)}),this.state.selectedObjects.clear());let e;return this.state.selectedObjects.has(t)?(e=t.userData.selectionColor,this.removeSelection(t)):(this.addSelection(t),e=t.userData.selectionColor),this.notifySelectionCallbacks(),e}getNextSelectionColor(){const t=new Map;this.state.selectedObjects.forEach(o=>{const s=o.userData.selectionColor;t.set(s,(t.get(s)||0)+1)});let e=this.options.selection.markerColors.find(o=>!t.has(o));if(!e){const o=Math.min(...t.values());e=this.options.selection.markerColors.find(s=>t.get(s)===o)}return e}addSelection(t){const e=this.getNextSelectionColor();this.state.selectedObjects.add(t);const o=t.material.clone();o.emissive.setHex(this.options.selection.highlightEmissive),t.userData.originalMaterial=t.material,t.material=o;const r=this.state.ortepObjects.get(t).createSelectionMarker(e,this.options);t.add(r),t.userData.marker=r,t.userData.selectionColor=e}removeSelection(t){if(this.state.selectedObjects.delete(t),t.userData.marker){t.remove(t.userData.marker);try{t.userData.marker.geometry.dispose(),t.userData.marker.material.dispose()}catch{t.userData.marker.dispose()}t.userData.marker=null}t.userData.originalMaterial&&(t.material.dispose(),t.material=t.userData.originalMaterial,t.userData.originalMaterial=null)}clearSelections(){this.state.selectedObjects.forEach(t=>{this.removeSelection(t)}),this.notifySelectionCallbacks()}selectAtoms(t){this.clearSelections(),t.forEach(e=>{const o=this.findAtomMeshByLabel(e);o&&this.addSelection(o)}),this.notifySelectionCallbacks()}findAtomMeshByLabel(t){let e=null;return this.moleculeContainer.traverse(o=>{var s,r,a;((s=o.userData)==null?void 0:s.type)==="atom"&&((a=(r=o.userData)==null?void 0:r.atomData)==null?void 0:a.label)===t&&(e=o)}),e}onSelectionChange(t){this.state.selectionCallbacks.add(t)}notifySelectionCallbacks(){const t=Array.from(this.state.selectedObjects).map(e=>({type:e.userData.type,data:e.userData.type==="hbond"?e.userData.hbondData:e.userData.type==="bond"?e.userData.bondData:e.userData.atomData,color:e.userData.selectionColor}));this.state.selectionCallbacks.forEach(e=>e(t))}setSelectionMode(t){var e;if(t!=="single"&&t!=="multiple")throw new Error('Selection mode must be either "single" or "multiple"');if(this.options.selection.mode=t,t==="single"&&((e=this.state.selectedAtoms)==null?void 0:e.size)>1){const o=Array.from(this.state.selectedAtoms),s=o[o.length-1];this.clearSelections(),this.addSelection(s),this.notifySelectionCallbacks()}}dispose(){this.controls.dispose(),this.scene.traverse(t=>{t.geometry&&t.geometry.dispose(),t.material&&(Array.isArray(t.material)?t.material.forEach(e=>e.dispose()):t.material.dispose())}),this.renderer.dispose(),this.renderer.domElement.parentNode&&this.renderer.domElement.parentNode.removeChild(this.renderer.domElement),this.scene=null,this.camera=null,this.renderer=null,this.state=null,this.options=null}}const Ot={disorder:{all:'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><g id="g8" transform="translate(0,-0.09016496)"><g id="g7" transform="translate(0,0.52916667)"><g id="path2-16" transform="rotate(180,28.623599,19.40998)" style="stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1"><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.707504,13.775784 -5.401798,11.08337" id="path3-6" /><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.257812,13.556641 -5.402343,11.083984 0.90039,0.4375 5.400391,-11.083984 z" id="path4-1" /></g><g id="path2-1-2" transform="rotate(180,28.623599,19.40998)" style="stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1"><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.600535,13.775784 5.401798,11.08337" id="path5-7" /><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 29.050781,13.556641 -0.90039,0.4375 5.402343,11.083984 0.898438,-0.4375 z" id="path6-5" /></g><circle style="fill:#000000;stroke:#000000;stroke-width:0.564999" id="path1-9" cx="-28.593182" cy="-24.863596" r="2.3135188" transform="scale(-1)" /><circle style="fill:#000000;stroke:#000000;stroke-width:0.564999" id="path1-2-3" cx="-33.888008" cy="-14.141389" r="2.3135188" transform="scale(-1)" /><circle style="fill:#000000;stroke:#000000;stroke-width:0.564999" id="path1-7-9" cx="-23.298351" cy="-14.141389" r="2.3135188" transform="scale(-1)" /></g><g id="g6" transform="translate(0,-0.52916663)"><g id="path2" style="stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1"><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.707504,13.775784 -5.401798,11.08337" id="path3" /><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.257812,13.556641 -5.402343,11.083984 0.90039,0.4375 5.400391,-11.083984 z" id="path4" /></g><circle style="fill:#000000;stroke:#000000;stroke-width:0.564999" id="path1-2" cx="23.35919" cy="24.678572" r="2.3135188" /><g id="path2-1" style="stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1"><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.600535,13.775784 5.401798,11.08337" id="path5" /><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 29.050781,13.556641 -0.90039,0.4375 5.402343,11.083984 0.898438,-0.4375 z" id="path6" /></g><circle style="fill:#000000;stroke:#000000;stroke-width:0.564999" id="path1" cx="28.654018" cy="13.956366" r="2.3135188" /><circle style="fill:#000000;stroke:#000000;stroke-width:0.564999" id="path1-7" cx="33.948849" cy="24.678572" r="2.3135188" /></g></g></g></svg>',group1:'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><g id="path2-16" transform="rotate(180,28.623599,19.629481)" style="fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1"><path style="color:#000000;fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.707504,13.775784 -5.401798,11.08337" id="path3-6" /><path style="color:#000000;fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.257812,13.556641 -5.402343,11.083984 0.90039,0.4375 5.400391,-11.083984 z" id="path4-1" /></g><g id="path2-1-2" transform="rotate(180,28.623599,19.629481)" style="fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1"><path style="color:#000000;fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.600535,13.775784 5.401798,11.08337" id="path5-7" /><path style="color:#000000;fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 29.050781,13.556641 -0.90039,0.4375 5.402343,11.083984 0.898438,-0.4375 z" id="path6-5" /></g><circle style="fill:#a4a4a4;fill-opacity:1;stroke:#a4a4a4;stroke-width:0.564999;stroke-opacity:1" id="path1-9" cx="-28.593182" cy="-25.302597" r="2.3135188" transform="scale(-1)" /><circle style="fill:#a4a4a4;fill-opacity:1;stroke:#a4a4a4;stroke-width:0.564999;stroke-opacity:1" id="path1-2-3" cx="-33.888008" cy="-14.580391" r="2.3135188" transform="scale(-1)" /><circle style="fill:#a4a4a4;fill-opacity:1;stroke:#a4a4a4;stroke-width:0.564999;stroke-opacity:1" id="path1-7-9" cx="-23.298351" cy="-14.580391" r="2.3135188" transform="scale(-1)" /><g id="g6" transform="translate(0,-0.61933159)"><g id="path2" style="stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1"><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.707504,13.775784 -5.401798,11.08337" id="path3" /><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.257812,13.556641 -5.402343,11.083984 0.90039,0.4375 5.400391,-11.083984 z" id="path4" /></g><circle style="fill:#000000;stroke:#000000;stroke-width:0.564999" id="path1-2" cx="23.35919" cy="24.678572" r="2.3135188" /><g id="path2-1" style="stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1"><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.600535,13.775784 5.401798,11.08337" id="path5" /><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 29.050781,13.556641 -0.90039,0.4375 5.402343,11.083984 0.898438,-0.4375 z" id="path6" /></g><circle style="fill:#000000;stroke:#000000;stroke-width:0.564999" id="path1" cx="28.654018" cy="13.956366" r="2.3135188" /><circle style="fill:#000000;stroke:#000000;stroke-width:0.564999" id="path1-7" cx="33.948849" cy="24.678572" r="2.3135188" /></g></g></svg>',group2:'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><g id="path2-16" transform="rotate(180,28.623599,19.629481)" style="fill:#000000;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1"><path style="color:#000000;fill:#000000;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.707504,13.775784 -5.401798,11.08337" id="path3-6" /><path style="color:#000000;fill:#000000;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.257812,13.556641 -5.402343,11.083984 0.90039,0.4375 5.400391,-11.083984 z" id="path4-1" /></g><g id="path2-1-2" transform="rotate(180,28.623599,19.629481)" style="fill:#000000;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1"><path style="color:#000000;fill:#000000;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.600535,13.775784 5.401798,11.08337" id="path5-7" /><path style="color:#000000;fill:#000000;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 29.050781,13.556641 -0.90039,0.4375 5.402343,11.083984 0.898438,-0.4375 z" id="path6-5" /></g><circle style="fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:0.564999;stroke-opacity:1" id="path1-9" cx="-28.593182" cy="-25.302597" r="2.3135188" transform="scale(-1)" /><circle style="fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:0.564999;stroke-opacity:1" id="path1-2-3" cx="-33.888008" cy="-14.580391" r="2.3135188" transform="scale(-1)" /><circle style="fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:0.564999;stroke-opacity:1" id="path1-7-9" cx="-23.298351" cy="-14.580391" r="2.3135188" transform="scale(-1)" /><g id="path2" style="fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" transform="translate(0,-0.61933159)"><path style="color:#000000;fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.707504,13.775784 -5.401798,11.08337" id="path3" /><path style="color:#000000;fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.257812,13.556641 -5.402343,11.083984 0.90039,0.4375 5.400391,-11.083984 z" id="path4" /></g><circle style="fill:#a4a4a4;fill-opacity:1;stroke:#a4a4a4;stroke-width:0.564999;stroke-opacity:1" id="path1-2" cx="23.35919" cy="24.05924" r="2.3135188" /><g id="path2-1" style="fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" transform="translate(0,-0.61933159)"><path style="color:#000000;fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 28.600535,13.775784 5.401798,11.08337" id="path5" /><path style="color:#000000;fill:#a4a4a4;fill-opacity:1;stroke:#ffffff;stroke-width:0.2;stroke-dasharray:none;stroke-opacity:1" d="m 29.050781,13.556641 -0.90039,0.4375 5.402343,11.083984 0.898438,-0.4375 z" id="path6" /></g><circle style="fill:#a4a4a4;fill-opacity:1;stroke:#a4a4a4;stroke-width:0.564999;stroke-opacity:1" id="path1" cx="28.654018" cy="13.337034" r="2.3135188" /><circle style="fill:#a4a4a4;fill-opacity:1;stroke:#a4a4a4;stroke-width:0.564999;stroke-opacity:1" id="path1-7" cx="33.948849" cy="24.05924" r="2.3135188" /></g></svg>'},hydrogen:{anisotropic:'<svg width="17.85038mm" height="17.850386mm" viewBox="0 0 17.85038 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-78.600695,-38.873141)"><text xml:space="preserve" style="font-size:8.46667px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.677999;stroke-linecap:butt;stroke-dasharray:none;stroke-opacity:1" x="84.344688" y="50.876183" id="text3-1-5-9"><tspan id="tspan3-4-4-0" style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.678;stroke-opacity:1" x="84.344688" y="50.876183">H</tspan></text><ellipse style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.816;stroke-linecap:butt;stroke-dasharray:none;stroke-opacity:1" id="path7-4" cx="41.174881" cy="90.830009" rx="4.9952669" ry="9.7379656" transform="rotate(-36.975178)" /></g></svg>',constant:'<svg width="17.850388mm" height="17.850386mm" viewBox="0 0 17.850388 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-58.39314,-38.873141)"><text xml:space="preserve" style="font-size:8.46667px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.677999;stroke-linecap:butt;stroke-dasharray:none;stroke-opacity:1" x="64.137131" y="50.876183" id="text3-1-8"><tspan id="tspan3-4-1" style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.678;stroke-opacity:1" x="64.137131" y="50.876183">H</tspan></text><circle style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.816;stroke-linecap:butt;stroke-dasharray:none;stroke-opacity:1" id="path6-0" cx="67.318336" cy="47.798332" r="6.8755083" /></g></svg>',none:'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-37.755639,-38.873141)"><text xml:space="preserve" style="font-size:8.46667px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.677999;stroke-linecap:butt;stroke-dasharray:none;stroke-opacity:1" x="43.499626" y="50.876183" id="text3-6" ><tspan id="tspan3-5" style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.678;stroke-opacity:1" x="43.499626" y="50.876183">H</tspan></text><path style="fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:0.816;stroke-linecap:butt;stroke-dasharray:none;stroke-opacity:1" d="m 39.917575,41.035079 13.526512,13.52651" id="path5-9" /><path style="fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:0.816;stroke-linecap:butt;stroke-dasharray:none;stroke-opacity:1" d="M 53.444087,41.035079 39.917575,54.561589" id="path5-1-0" /></g></svg>'},symmetry:{"bonds-no-hbonds-no":'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><rect style="fill:#ffffff;fill-opacity:1;stroke:#ffffff;stroke-width:0.355503;stroke-dasharray:none;stroke-dashoffset:0.0831496;stroke-opacity:1" id="rect25" width="1.3572845" height="1.1344972" x="27.961069" y="23.823376" /><g id="path8" style="stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill:#808080;fill-opacity:1"><path style="color:#000000;fill:#808080;stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill-opacity:1" d="m 23.654019,14.248425 h 10" id="path23" /><path style="color:#000000;fill:#808080;stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill-opacity:1" d="m 23.654297,13.648438 v 1.199218 h 10 v -1.199218 z" id="path22" /></g><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7" cx="23.335806" cy="14.248425" r="2.3135188" /><circle style="fill:#808080;stroke:none;stroke-width:0.564999;fill-opacity:1" id="path1-7-7" cx="33.972233" cy="14.248425" r="2.3135188" /><path style="color:#000000;fill:#000000;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.108" d="m 23.654019,24.391204 h 10" id="path25" /><path style="color:#000000;fill:#808080;stroke:#ffffff;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.022;stroke-opacity:1;fill-opacity:1" d="m 23.625124,23.791016 v 1.199218 h 1.091797 v -1.199218 z m 1.691406,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800781,0 v 1.199218 h 1.199219 v -1.199218 z m 1.828001,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800782,0 v 1.199218 h 1.199218 v -1.199218 z m 1.800781,0 v 1.199218 h 1.107422 v -1.199218 z" id="path24" /><circle style="fill:#808080;stroke:none;stroke-width:0.564999;fill-opacity:1" id="path1-7-53" cx="33.972233" cy="24.391207" r="2.3135188" /><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7-5" cx="23.335806" cy="24.391207" r="2.3135188" /><path style="fill:#000000;stroke:#000000;stroke-width:0.6;stroke-dasharray:none" d="M 28.654019,10.932651 V 27.762155" id="path7" /></g></svg>',"bonds-no-hbonds-none":'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><g id="path8" style="fill:#808080;fill-opacity:1;stroke:#ffffff;stroke-width:0.4;stroke-dasharray:none;stroke-opacity:1" transform="translate(0,5.0717688)"><path style="color:#000000;fill:#808080;fill-opacity:1;stroke:#ffffff;stroke-width:0.4;stroke-dasharray:none;stroke-opacity:1" d="m 23.654019,14.248425 h 10" id="path23" /><path style="color:#000000;fill:#808080;fill-opacity:1;stroke:#ffffff;stroke-width:0.4;stroke-dasharray:none;stroke-opacity:1" d="m 23.654297,13.648438 v 1.199218 h 10 v -1.199218 z" id="path22" /></g><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7" cx="23.335806" cy="19.319817" r="2.3135188" /><circle style="fill:#808080;fill-opacity:1;stroke:none;stroke-width:0.564999" id="path1-7-7" cx="33.972233" cy="19.319817" r="2.3135188" /><path style="fill:#000000;stroke:#000000;stroke-width:0.6;stroke-dasharray:none" d="M 28.654019,10.932651 V 27.762155" id="path7" /></g></svg>',"bonds-no-hbonds-yes":'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><rect style="fill:#000000;fill-opacity:1;stroke:#ffffff;stroke-width:0.355503;stroke-dasharray:none;stroke-dashoffset:0.0831496;stroke-opacity:1" id="rect25" width="1.3572845" height="1.1344972" x="27.961069" y="23.823376" /><g id="path8" style="stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill:#808080;fill-opacity:1"><path style="color:#000000;fill:#808080;stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill-opacity:1" d="m 23.654019,14.248425 h 10" id="path23" /><path style="color:#000000;fill:#808080;stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill-opacity:1" d="m 23.654297,13.648438 v 1.199218 h 10 v -1.199218 z" id="path22" /></g><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7" cx="23.335806" cy="14.248425" r="2.3135188" /><circle style="fill:#808080;stroke:none;stroke-width:0.564999;fill-opacity:1" id="path1-7-7" cx="33.972233" cy="14.248425" r="2.3135188" /><path style="color:#000000;fill:#000000;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.108;fill-opacity:1" d="m 23.654019,24.391204 h 10" id="path25" /><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.022;stroke-opacity:1;fill-opacity:1" d="m 23.625124,23.791016 v 1.199218 h 1.091797 v -1.199218 z m 1.691406,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800781,0 v 1.199218 h 1.199219 v -1.199218 z m 1.828001,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800782,0 v 1.199218 h 1.199218 v -1.199218 z m 1.800781,0 v 1.199218 h 1.107422 v -1.199218 z" id="path24" /><circle style="fill:#000000;stroke:none;stroke-width:0.564999;fill-opacity:1" id="path1-7-53" cx="33.972233" cy="24.391207" r="2.3135188" /><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7-5" cx="23.335806" cy="24.391207" r="2.3135188" /><path style="fill:#000000;stroke:#000000;stroke-width:0.6;stroke-dasharray:none" d="M 28.654019,10.932651 V 27.762155" id="path7" /></g></svg>',"bonds-none-hbonds-no":'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><rect style="fill:#ffffff;fill-opacity:1;stroke:#ffffff;stroke-width:0.355503;stroke-dasharray:none;stroke-dashoffset:0.0831496;stroke-opacity:1" id="rect25" width="1.3572845" height="1.1344972" x="27.961069" y="18.752567" /><path style="color:#000000;fill:#000000;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.108" d="m 23.654019,19.319816 h 10" id="path25" /><path style="color:#000000;fill:#808080;fill-opacity:1;stroke:#ffffff;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.022;stroke-opacity:1" d="m 23.625124,18.720207 v 1.199218 h 1.091797 v -1.199218 z m 1.691406,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800781,0 v 1.199218 h 1.199219 v -1.199218 z m 1.828001,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800782,0 v 1.199218 h 1.199218 v -1.199218 z m 1.800781,0 v 1.199218 h 1.107422 v -1.199218 z" id="path24" /><circle style="fill:#808080;fill-opacity:1;stroke:none;stroke-width:0.564999" id="path1-7-53" cx="33.972233" cy="19.319817" r="2.3135188" /><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7-5" cx="23.335806" cy="19.319817" r="2.3135188" /><path style="fill:#000000;stroke:#000000;stroke-width:0.6;stroke-dasharray:none" d="M 28.654019,10.932651 V 27.762155" id="path7" /></g></svg>',"bonds-none-hbonds-yes":'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><path style="fill:#000000;stroke:#000000;stroke-width:0.6;stroke-dasharray:none" d="M 28.654019,10.932651 V 27.762155" id="path7" /><rect style="fill:#ffffff;fill-opacity:1;stroke:#ffffff;stroke-width:0.355503;stroke-dasharray:none;stroke-dashoffset:0.0831496;stroke-opacity:1" id="rect25" width="1.3572845" height="1.1344972" x="27.961069" y="18.752567" /><path style="color:#000000;fill:#000000;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.108" d="m 23.654019,19.319816 h 10" id="path25" /><path style="color:#000000;fill:#000000;fill-opacity:1;stroke:#ffffff;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.022;stroke-opacity:1" d="m 23.625124,18.720207 v 1.199218 h 1.091797 v -1.199218 z m 1.691406,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800781,0 v 1.199218 h 1.199219 v -1.199218 z m 1.828001,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800782,0 v 1.199218 h 1.199218 v -1.199218 z m 1.800781,0 v 1.199218 h 1.107422 v -1.199218 z" id="path24" /><circle style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.564999" id="path1-7-53" cx="33.972233" cy="19.319817" r="2.3135188" /><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7-5" cx="23.335806" cy="19.319817" r="2.3135188" /></g></svg>',"bonds-yes-hbonds-no":'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><rect style="fill:#ffffff;fill-opacity:1;stroke:#ffffff;stroke-width:0.355503;stroke-dasharray:none;stroke-dashoffset:0.0831496;stroke-opacity:1" id="rect25" width="1.3572845" height="1.1344972" x="27.961069" y="23.823376" /><path style="color:#000000;fill:#000000;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.108" d="m 23.654019,24.391204 h 10" id="path25" /><path style="color:#000000;fill:#808080;stroke:#ffffff;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.022;stroke-opacity:1;fill-opacity:1" d="m 23.625124,23.791016 v 1.199218 h 1.091797 v -1.199218 z m 1.691406,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800781,0 v 1.199218 h 1.199219 v -1.199218 z m 1.828001,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800782,0 v 1.199218 h 1.199218 v -1.199218 z m 1.800781,0 v 1.199218 h 1.107422 v -1.199218 z" id="path24" /><circle style="fill:#808080;stroke:none;stroke-width:0.564999;fill-opacity:1" id="path1-7-53" cx="33.972233" cy="24.391207" r="2.3135188" /><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7-5" cx="23.335806" cy="24.391207" r="2.3135188" /><path style="fill:#000000;stroke:#000000;stroke-width:0.6;stroke-dasharray:none" d="M 28.654019,10.932651 V 27.762155" id="path7" /><g id="path8" style="stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill:#000000;fill-opacity:1"><path style="color:#000000;fill:#000000;stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill-opacity:1" d="m 23.654019,14.248425 h 10" id="path23" /><path style="color:#000000;fill:#000000;stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill-opacity:1" d="m 23.654297,13.648438 v 1.199218 h 10 v -1.199218 z" id="path22" /></g><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7" cx="23.335806" cy="14.248425" r="2.3135188" /><circle style="fill:#000000;stroke:none;stroke-width:0.564999;fill-opacity:1" id="path1-7-7" cx="33.972233" cy="14.248425" r="2.3135188" /></g></svg>',"bonds-yes-hbonds-none":'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><path style="fill:#000000;stroke:#000000;stroke-width:0.6;stroke-dasharray:none" d="M 28.654019,10.932651 V 27.762155" id="path7" /><g id="path8" style="fill:#000000;fill-opacity:1;stroke:#ffffff;stroke-width:0.4;stroke-dasharray:none;stroke-opacity:1" transform="translate(0,5.0717688)"><path style="color:#000000;fill:#000000;fill-opacity:1;stroke:#ffffff;stroke-width:0.4;stroke-dasharray:none;stroke-opacity:1" d="m 23.654019,14.248425 h 10" id="path23" /><path style="color:#000000;fill:#000000;fill-opacity:1;stroke:#ffffff;stroke-width:0.4;stroke-dasharray:none;stroke-opacity:1" d="m 23.654297,13.648438 v 1.199218 h 10 v -1.199218 z" id="path22" /></g><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7" cx="23.335806" cy="19.319817" r="2.3135188" /><circle style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.564999" id="path1-7-7" cx="33.972233" cy="19.319817" r="2.3135188" /></g></svg>',"bonds-yes-hbonds-yes":'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1" /><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><path style="fill:#000000;stroke:#000000;stroke-width:0.6;stroke-dasharray:none" d="M 28.654019,10.932651 V 27.762155" id="path7" /><g id="path8" style="stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill:#000000;fill-opacity:1"><path style="color:#000000;fill:#000000;stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill-opacity:1" d="m 23.654019,14.248425 h 10" id="path23" /><path style="color:#000000;fill:#000000;stroke-width:0.4;stroke-dasharray:none;stroke:#ffffff;stroke-opacity:1;fill-opacity:1" d="m 23.654297,13.648438 v 1.199218 h 10 v -1.199218 z" id="path22" /></g><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7" cx="23.335806" cy="14.248425" r="2.3135188" /><circle style="fill:#000000;stroke:none;stroke-width:0.564999;fill-opacity:1" id="path1-7-7" cx="33.972233" cy="14.248425" r="2.3135188" /><rect style="fill:#ffffff;fill-opacity:1;stroke:#ffffff;stroke-width:0.355503;stroke-dasharray:none;stroke-dashoffset:0.0831496;stroke-opacity:1" id="rect25" width="1.3572845" height="1.1344972" x="27.961069" y="23.823376" /><path style="color:#000000;fill:#000000;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.108" d="m 23.654019,24.391204 h 10" id="path25" /><path style="color:#000000;fill:#000000;stroke:#ffffff;stroke-width:0.3;stroke-dasharray:none;stroke-dashoffset:0.022;stroke-opacity:1;fill-opacity:1" d="m 23.625124,23.791016 v 1.199218 h 1.091797 v -1.199218 z m 1.691406,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800781,0 v 1.199218 h 1.199219 v -1.199218 z m 1.828001,0 v 1.199218 h 1.201172 v -1.199218 z m 1.800782,0 v 1.199218 h 1.199218 v -1.199218 z m 1.800781,0 v 1.199218 h 1.107422 v -1.199218 z" id="path24" /><circle style="fill:#000000;stroke:none;stroke-width:0.564999;fill-opacity:1" id="path1-7-53" cx="33.972233" cy="24.391207" r="2.3135188" /><circle style="fill:#000000;stroke:none;stroke-width:0.565;stroke-dasharray:none" id="path1-7-5" cx="23.335806" cy="24.391207" r="2.3135188" /></g></svg>'},upload:{"":'<svg width="17.850384mm" height="17.850386mm" viewBox="0 0 17.850384 17.850386" version="1.1" id="svg1" (0e150ed6c4, 2023-07-21)"xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><id="namedview1" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" showguides="false" /><defs id="defs1"><marker style="overflow:visible" id="ArrowWide" refX="0" refY="0" orient="auto-start-reverse" arrow" markerWidth="1" markerHeight="1" viewBox="0 0 1 1" preserveAspectRatio="xMidYMid"><path style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt" d="M 3,-3 0,0 3,3" transform="rotate(180,0.125,0)" id="path1" /></marker></defs><g 1" id="layer1" transform="translate(-19.728827,-10.394623)"><text xml:space="preserve" style="font-size:7.05556px;fill:#e6e6e6;stroke:none;stroke-width:0.5;stroke-linecap:round;stroke-dasharray:none" x="22.242813" y="28.151989" id="text2"><tspan id="tspan2" style="font-size:7.05556px;fill:#1a1a1a;stroke-width:0.5;stroke-linecap:round;stroke-dasharray:none" x="22.242813" y="28.151989">CIF</tspan></text><path style="fill:none;stroke:#000000;stroke-width:0.68;stroke-linecap:butt;stroke-dasharray:none;stroke-opacity:1" d="m 20.714121,18.107197 v 3.07807 h 15.879794 v -3.07807" id="path2" /><path style="fill:none;stroke:#000000;stroke-width:0.68;stroke-linecap:butt;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#ArrowWide)" d="M 28.654018,19.170064 V 11.045456" id="path3" /></g></svg>'}};function ct(l,t,e=4){if(!isFinite(1/t))return J(l,e).toFixed(e);let o=Math.floor(Math.log10(t));t*Math.pow(10,-o)<2&&(o-=1);const s=J(l,-o);if(o<0){const a=Math.round(t/Math.pow(10,o));return`${s.toFixed(-o)}(${a})`}const r=J(t,o);return`${s}(${r})`}function J(l,t){const e=Math.pow(10,t);return Math.round(l*e)/e}const Et=`
  cifview-widget {
    display: flex;
    flex-direction: column;
    font-family: system-ui, -apple-system, sans-serif;
    height: 100%;
    position: relative;
    background: #fafafa;
    border-radius: 8px;
    overflow: hidden;
  }

  cifview-widget .crystal-container {
    flex: 1;
    min-height: 0;
    position: relative;
  }

  cifview-widget .crystal-caption {
    padding: 12px 16px;
    background: #ffffff;
    border-top: 1px solid #eaeaea;
    color: #333;
    font-size: 14px;
    line-height: 1.5;
  }

  cifview-widget .button-container {
    position: absolute;
    top: 16px;
    right: 16px;
    display: flex;
    gap: 8px;
    z-index: 1000;
  }

  cifview-widget .control-button {
    width: 40px;
    height: 40px;
    border: none;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.9);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 8px;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }

  cifview-widget .control-button:hover {
    background: #ffffff;
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  }

  cifview-widget .control-button svg {
    width: 24px;
    height: 24px;
  }
`;class ht extends HTMLElement{static get observedAttributes(){return["caption","src","data","icons"]}constructor(){if(super(),!document.getElementById("cifview-styles")){const t=document.createElement("style");t.id="cifview-styles",t.textContent=Et,document.head.appendChild(t)}this.viewer=null,this.baseCaption="",this.selections=[],this.customIcons=null}get icons(){return{...{hydrogen:{none:"",constant:"",anisotropic:""},disorder:{all:"",group1:"",group2:""},symmetry:{"bonds-yes-hbonds-yes":"","bonds-yes-hbonds-no":"","bonds-no-hbonds-no":""}},...Ot,...this.customIcons}}async connectedCallback(){this.baseCaption=this.getAttribute("caption")||"",this.customIcons=this.parseCustomIcons();const t=document.createElement("div");t.className="crystal-container",this.appendChild(t);const e=document.createElement("div");e.className="button-container",t.appendChild(e),this.buttonContainer=e;const o=document.createElement("div");o.className="crystal-caption",o.textContent=this.baseCaption,this.appendChild(o),this.captionElement=o,this.viewer=new dt(t),this.viewer.onSelectionChange(a=>{this.selections=a,this.updateCaption()});const s=this.getAttribute("src"),r=this.getAttribute("data");s?await this.loadFromUrl(s):r&&await this.loadFromString(r)}clearButtons(){if(this.buttonContainer)for(;this.buttonContainer.firstChild;)this.buttonContainer.removeChild(this.buttonContainer.firstChild)}setupButtons(){if(!this.viewer||!this.viewer.state.baseStructure)return;this.clearButtons();const t=this.viewer.modifiers.hydrogen.getApplicableModes(this.viewer.state.baseStructure).length>1,e=this.viewer.modifiers.disorder.getApplicableModes(this.viewer.state.baseStructure).length>1,o=this.viewer.modifiers.symmetry.getApplicableModes(this.viewer.state.baseStructure).length>1;t&&this.addButton(this.buttonContainer,"hydrogen","none","Toggle Hydrogen Display"),e&&this.addButton(this.buttonContainer,"disorder","all","Toggle Disorder Display"),o&&this.addButton(this.buttonContainer,"symmetry","bonds-no-hbonds-no","Toggle Symmetry Display")}parseCustomIcons(){try{const t={hydrogen:{src:this.getAttribute("hydrogen-icons"),modes:["none","constant","anisotropic"]},disorder:{src:this.getAttribute("disorder-icons"),modes:["all","group1","group2"]},symmetry:{src:this.getAttribute("symmetry-icons"),modes:["bonds-yes-hbonds-yes","bonds-yes-hbonds-no","bonds-no-hbonds-no"]}},e={};for(const[o,s]of Object.entries(t))if(s.src){const r=s.src.split(",");e[o]={},s.modes.forEach((a,i)=>{r[i]&&(e[o][a]=r[i].trim())})}return Object.keys(e).length?e:null}catch(t){return console.warn("Failed to parse custom icons:",t),null}}parseCustomIcons(){const t=this.getAttribute("icons");if(!t)return null;try{return JSON.parse(t)}catch(e){return console.warn("Failed to parse custom icons:",e),null}}addButton(t,e,o,s){const r=document.createElement("button");r.className=`control-button ${e}-button`,r.innerHTML=this.icons[e][o],r.title=s;const a=r.querySelector("svg");a&&(a.setAttribute("alt",s),a.setAttribute("role","img"),a.setAttribute("aria-label",s)),t.appendChild(r),r.addEventListener("click",async()=>{const i=await this.viewer[`cycle${e.charAt(0).toUpperCase()+e.slice(1)}Mode`]();i.success&&(r.innerHTML=this.icons[e][i.mode])})}async attributeChangedCallback(t,e,o){if(this.viewer)switch(t){case"caption":this.baseCaption=o,this.updateCaption();break;case"src":o&&await this.loadFromUrl(o);break;case"data":o&&await this.loadFromString(o);break;case"icons":this.customIcons=this.parseCustomIcons();break}}async loadFromUrl(t){try{const o=await(await fetch(t)).text();await this.viewer.loadStructure(o),this.setupButtons()}catch(e){console.error("Error loading structure:",e)}}async loadFromString(t){try{await this.viewer.loadStructure(t),this.setupButtons()}catch(e){console.error("Error loading structure:",e)}}updateCaption(){let t=this.baseCaption;if(this.selections.length>0){t.endsWith(".")||(t+="."),t+=" Selected Atoms and Bonds: ";const e=this.selections.map(o=>{const s="#"+o.color.toString(16).padStart(6,"0");let r="";if(o.type==="atom")r=`${o.data.label} (${o.data.atomType})`;else if(o.type==="bond"){const a=ct(o.data.bondLength,o.data.bondLengthSU);r=`${o.data.atom1Label}-${o.data.atom2Label}: ${a} Å`}return`<span style="color:${s}">${r}</span>`}).join(", ");t+=e+"."}this.captionElement.innerHTML=t}disconnectedCallback(){this.viewer&&this.viewer.dispose()}}customElements.define("cifview-widget",ht),p.CIF=et,p.CifViewWidget=ht,p.CrystalStructure=O,p.CrystalViewer=dt,p.ORTEP3JsStructure=nt,p.formatValueEsd=ct,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});


            // Initialize with CIF data
            const widget = document.getElementById('cifview');

            // Wait for custom element to be defined and connected
            customElements.whenDefined('cifview-widget').then(() => {
                const cifData = atob("ZGF0YV8yMzA1MTM5Cl9zcGFjZV9ncm91cC5jcnlzdGFsX3N5c3RlbSAgICAgICBtb25vY2xpbmljCl9zcGFjZV9ncm91cC5pdF9udW1iZXIgICAgICAgICAgICAxNApsb29wXwogIF9zcGFjZV9ncm91cF9zeW1vcC5vcGVyYXRpb25feHl6CiAgeCx5LHoKICAteCx5KzEvMiwteisxLzIKICAteCwteSwtegogIHgsLXktMS8yLHotMS8yCgpfY2VsbC5sZW5ndGhfYSAgICAgICAgICAgICAgICAgICAgOS4zMzQ1Cl9jZWxsLmxlbmd0aF9iICAgICAgICAgICAgICAgICAgICAxNC43NDUKX2NlbGwubGVuZ3RoX2MgICAgICAgICAgICAgICAgICAgIDE0LjYzOTMKX2NlbGwuYW5nbGVfYWxwaGEgICAgICAgICAgICAgICAgIDkwCl9jZWxsLmFuZ2xlX2JldGEgICAgICAgICAgICAgICAgICAxMDYuMDUKX2NlbGwuYW5nbGVfZ2FtbWEgICAgICAgICAgICAgICAgIDkwCmxvb3BfCiAgX2F0b21fc2l0ZS5sYWJlbAogIF9hdG9tX3NpdGUudHlwZV9zeW1ib2wKICBfYXRvbV9zaXRlLmZyYWN0X3gKICBfYXRvbV9zaXRlLmZyYWN0X3kKICBfYXRvbV9zaXRlLmZyYWN0X3oKICBfYXRvbV9zaXRlLnVfaXNvX29yX2VxdWl2CiAgX2F0b21fc2l0ZS5hZHBfdHlwZQogIE5pMDEgIE5pICAwLjUxODIxNyAgMC42NTkyOTMgIDAuMjI5Mzg3ICAwLjAyNzk5ICBVYW5pCiAgUDIgICAgUCAgICAwLjQ5ODE2ICAgMC43NTk3MiAgIDAuMTEyNzEgICAwLjA1NTQgIFVhbmkKICBQMSAgICBQICAgIDAuNzE1MDUgICAwLjcyNzM3ICAgMC4yMDAwNCAgIDAuMDU0OSAgVWFuaQogIFAzICAgIFAgICAgMC41OTUwNyAgIDAuNjMxMjcgICAgMC4xMDAxICAgMC4wNjQyICBVYW5pCiAgQzAwNSAgQyAgICAwLjU3MTI2ICAgMC41OTYwNSAgIDAuMzYyMjEgIDAuMDI3MDMgIFVhbmkKICBDMDA2ICBDICAgIDAuNzIzNDkgICAwLjU3MjM4ICAgMC40Mjc0NyAgIDAuMDMyMSAgVWFuaQogIEMwMDcgIEMgICAgMC40ODgzNiAgIDAuNjc2NjIgICAwLjM2MzIxICAwLjAyNjU1ICBVYW5pCiAgQzAwOCAgQyAgICAwLjQ3ODE0ICAgMC41Mzk1NCAgICAwLjI5MTMgIDAuMDMwNDMgIFVhbmkKICBDMDA5ICBDICAgIDAuMzQ1MDEgICAwLjY3MTk0ICAgMC4yOTQ0OCAgMC4wMjcxNCAgVWFuaQogIEMwMEEgIEMgICAgMC4zMzg0NiAgIDAuNTgzOTkgICAwLjI0NzI5ICAwLjAyOTM3ICBVYW5pCiAgQzAwQiAgQyAgICAwLjIzMTM1ICAgMC43NDc3NyAgIDAuMjkyODcgIDAuMDMzMTcgIFVhbmkKICBDMDBDICBDICAgIDAuMjE2NjUgICAwLjUzNjAzICAgMC4xNjk0MiAgMC4wMzk1OSAgVWFuaQogIEMwMEQgIEMgICAgMC44MTI0OCAgIDAuNjU3OTIgICAwLjQ2NjAyICAgMC4wNDM5ICBVYW5pCiAgQzAwRSAgQyAgICAwLjMxMjgxICAgMC44Mzc2NiAgIDAuMzI2ODQgICAwLjA0MzMgIFVhbmkKICBDMDBGICBDICAgIDAuMTc4NDUgICAwLjU4NTY3ICAgMC4wNzMxNSAgICAwLjA1MSAgVWFuaQogIEMwMEcgIEMgICAgIDAuMTQ0NCAgIDAuNzIxNjYgICAwLjM2NDYxICAgMC4wNDY5ICBVYW5pCiAgQzAwSCAgQyAgICAwLjEyMTM4ICAgMC43NjcyMyAgIDAuMTk1OTUgICAwLjA0NDcgIFVhbmkKICBDMDBJICBDICAgIDAuNzAwNDUgICAwLjUxNzg5ICAgIDAuNTExNiAgIDAuMDU0MSAgVWFuaQogIEMwMEogIEMgICAgMC4yNzA0NiAgIDAuNDQxMjMgICAwLjE1MDA1ICAgMC4wNjQ2ICBVYW5pCiAgQzAwSyAgQyAgICAwLjgxMjAxICAgIDAuNTE1OCAgIDAuMzc0NzggICAwLjA1MzcgIFVhbmkKICBDMDBMICBDICAgIDAuMDc1NzIgICAwLjUyMzQzICAgMC4yMDI4NyAgICAwLjA1NSAgVWFuaQogIEgwMDggIEggICAgMC41MDQxNiAgIDAuNDgxMjUgICAwLjI3NTM3ICAwLjAzNjUxICBVaXNvCiAgSDAwNyAgSCAgICAwLjUyMjcxICAgMC43MjYzNyAgIDAuNDAzNDYgIDAuMDMxODYgIFVpc28KICBIMDBhICBIICAgICAwLjgyNDQgICAgMC42OTQzICAgMC40MTM0MiAgIDAuMDY1OSAgVWlzbwogIEgwMGIgIEggICAgIDAuNzU5NyAgICAwLjY5MjcgICAgMC41MDI3ICAgMC4wNjU5ICBVaXNvCiAgSDAwYyAgSCAgICAgMC45MDk4ICAgMC42NDA5MSAgICAwLjUwNjQgICAwLjA2NTkgIFVpc28KICBIMDBkICBIICAgICAwLjM3NDEgICAgMC44MzA5ICAgIDAuMzkxOCAgIDAuMDY0OSAgVWlzbwogIEgwMGUgIEggICAgIDAuMzc1NCAgICAwLjg1MzMgICAgMC4yODYyICAgMC4wNjQ5ICBVaXNvCiAgSDAwZiAgSCAgICAwLjI0MDE2ICAgMC44ODUzOSAgICAwLjMyMzkgICAwLjA2NDkgIFVpc28KICBIMDBnICBIICAgICAwLjE0NTggICAgMC42NDY5ICAgMC4wODExMiAgIDAuMDc2NSAgVWlzbwogIEgwMGggIEggICAgIDAuMjY2MSAgICAgMC41ODggICAgMC4wNDk5ICAgMC4wNzY1ICBVaXNvCiAgSDAwaSAgSCAgICAgMC4wOTk0ICAgIDAuNTUzNCAgICAwLjAyNzggICAwLjA3NjUgIFVpc28KICBIMDBqICBIICAgICAwLjA4OTUgICAgIDAuNjY2ICAgIDAuMzQ0MSAgIDAuMDcwMyAgVWlzbwogIEgwMGsgIEggICAgMC4yMTM3NiAgICAwLjcxMjcgICAwLjQyNjg2ICAgMC4wNzAzICBVaXNvCiAgSDAwbCAgSCAgICAgMC4wNzUzICAgIDAuNzY5OSAgICAwLjM2NzkgICAwLjA3MDMgIFVpc28KICBIMDBtICBIICAgIDAuMTc2MDcgICAgMC43ODMyICAgMC4xNTA3NSAgIDAuMDY3MSAgVWlzbwogIEgwMG4gIEggICAgIDAuMDYxNSAgICAwLjcxMzYgICAgMC4xNzM4ICAgMC4wNjcxICBVaXNvCiAgSDAwbyAgSCAgICAgMC4wNTY5ICAgIDAuODE3MSAgIDAuMjAxODYgICAwLjA2NzEgIFVpc28KICBIMDBwICBIICAgICAwLjY0MzYgICAgMC41NTM4ICAgIDAuNTQ0OCAgIDAuMDgxMiAgVWlzbwogIEgwMHEgIEggICAgIDAuNjQ2NiAgICAwLjQ2MjUgICAwLjQ4ODM3ICAgMC4wODEyICBVaXNvCiAgSDAwciAgSCAgICAwLjc5NjU5ICAgIDAuNTAyOSAgICAwLjU1NDggICAwLjA4MTIgIFVpc28KICBIMDBzICBIICAgICAwLjM1OTYgICAwLjQ0Njk1ICAgIDAuMTI4NyAgICAwLjA5NyAgVWlzbwogIEgwMHQgIEggICAgIDAuMjkyOCAgICAwLjQwNTYgICAgIDAuMjA4ICAgIDAuMDk3ICBVaXNvCiAgSDAwdSAgSCAgICAgIDAuMTkzICAgIDAuNDExNCAgICAwLjEwMTMgICAgMC4wOTcgIFVpc28KICBIMDB2ICBIICAgICAwLjc1OTcgICAgMC40NTk0ICAgIDAuMzUzNyAgIDAuMDgwNiAgVWlzbwogIEgwMHcgIEggICAgIDAuODIyOSAgICAwLjU0OTQgICAgMC4zMjAxICAgMC4wODA2ICBVaXNvCiAgSDAweCAgSCAgICAgMC45MDk4ICAgIDAuNTAyNiAgICAgMC40MTcgICAwLjA4MDYgIFVpc28KICBIMDB5ICBIICAgICAwLjEwMDYgICAgICAwLjQ5ICAgIDAuMjYyMiAgIDAuMDgyNSAgVWlzbwogIEggICAgIEggICAgIDAuMDM1OSAgIDAuNTgyMzUgICAgMC4yMTI0ICAgMC4wODI1ICBVaXNvCiAgSGEgICAgSCAgICAgMC4wMDE3ICAgICAgMC40OSAgICAwLjE1NTEgICAwLjA4MjUgIFVpc28KCmxvb3BfCiAgX2F0b21fc2l0ZV9hbmlzby5sYWJlbAogIF9hdG9tX3NpdGVfYW5pc28udV8xMQogIF9hdG9tX3NpdGVfYW5pc28udV8xMV9zdQogIF9hdG9tX3NpdGVfYW5pc28udV8yMgogIF9hdG9tX3NpdGVfYW5pc28udV8yMl9zdQogIF9hdG9tX3NpdGVfYW5pc28udV8zMwogIF9hdG9tX3NpdGVfYW5pc28udV8zM19zdQogIF9hdG9tX3NpdGVfYW5pc28udV8xMgogIF9hdG9tX3NpdGVfYW5pc28udV8xMl9zdQogIF9hdG9tX3NpdGVfYW5pc28udV8xMwogIF9hdG9tX3NpdGVfYW5pc28udV8xM19zdQogIF9hdG9tX3NpdGVfYW5pc28udV8yMwogIF9hdG9tX3NpdGVfYW5pc28udV8yM19zdQogIE5pMDEgIDAuMDI0NTEgICA1ZS0wNSAgMC4wMzg1NSAgIDZlLTA1ICAwLjAyMTA5ICAgNGUtMDUgIC0wLjAwMjcgICAzZS0wNSAgIDAuMDA2NiAgIDNlLTA1ICAwLjAwMTU0ICAgM2UtMDUKICBQMiAgICAgMC4wNTE3ICAwLjAwMDQgICAgMC4wNzQgIDAuMDAwNSAgIDAuMDQzMyAgMC4wMDAzICAgMC4wMDI2ICAwLjAwMDMgICAwLjAxNzkgIDAuMDAwMyAgIDAuMDI1OCAgMC4wMDAzCiAgUDEgICAgIDAuMDM2NiAgMC4wMDAzICAgMC4wODMxICAwLjAwMDYgICAwLjA0NzUgIDAuMDAwNCAgLTAuMDE1NyAgMC4wMDAzICAgIDAuMDE2ICAwLjAwMDMgICAwLjAwODEgIDAuMDAwNAogIFAzICAgICAwLjA4MTIgIDAuMDAwNiAgIDAuMDc4OCAgMC4wMDA2ICAgMC4wNDQ2ICAwLjAwMDQgIC0wLjAwNTYgIDAuMDAwNSAgIDAuMDM3MiAgMC4wMDA0ICAtMC4wMTAxICAwLjAwMDQKICBDMDA1ICAgIDAuMDIzICAwLjAwMDMgICAwLjAzNTQgIDAuMDAwMyAgIDAuMDIxNSAgMC4wMDAyICAgMC4wMDE0ICAwLjAwMDIgICAwLjAwNDIgIDAuMDAwMiAgIDAuMDAxNiAgMC4wMDAyCiAgQzAwNiAgIDAuMDI0NiAgMC4wMDAzICAgMC4wNDI1ICAwLjAwMDQgICAwLjAyNjMgIDAuMDAwMyAgIDAuMDA1NCAgMC4wMDAzICAgMC4wMDIxICAwLjAwMDIgIC0wLjAwMDUgIDAuMDAwMwogIEMwMDcgICAwLjAyMjUgIDAuMDAwMyAgIDAuMDM1MiAgMC4wMDAzICAgMC4wMjE0ICAwLjAwMDMgICAwLjAwMDYgIDAuMDAwMiAgIDAuMDA1MSAgMC4wMDAyICAgMC4wMDA1ICAwLjAwMDIKICBDMDA4ICAgMC4wMjg4ICAwLjAwMDMgICAwLjAzMjcgIDAuMDAwMyAgIDAuMDI3NSAgMC4wMDAzICAtMC4wMDA4ICAwLjAwMDMgICAwLjAwMzkgIDAuMDAwMiAgIDAuMDAwNSAgMC4wMDAzCiAgQzAwOSAgIDAuMDIxMyAgMC4wMDAzICAgMC4wMzU4ICAwLjAwMDMgICAwLjAyMzggIDAuMDAwMyAgLTAuMDAwNiAgMC4wMDAyICAgMC4wMDUyICAwLjAwMDIgICAgMC4wMDUgIDAuMDAwMgogIEMwMEEgICAwLjAyNDUgIDAuMDAwMyAgIDAuMDM1OSAgMC4wMDAzICAgMC4wMjUzICAwLjAwMDMgIC0wLjAwNDcgIDAuMDAwMyAgIDAuMDAyOSAgMC4wMDAyICAgMC4wMDI1ICAwLjAwMDMKICBDMDBCICAgMC4wMjQ3ICAwLjAwMDMgICAwLjA0MDkgIDAuMDAwNCAgIDAuMDMzMyAgMC4wMDAzICAgMC4wMDQ3ICAwLjAwMDMgICAwLjAwNjkgIDAuMDAwMyAgIDAuMDA2NyAgMC4wMDAzCiAgQzAwQyAgIDAuMDMzNSAgMC4wMDA0ICAgMC4wNDUxICAwLjAwMDUgICAwLjAzMzEgIDAuMDAwNCAgLTAuMDEwOSAgMC4wMDAzICAtMC4wMDI1ICAwLjAwMDMgICAgICAgIDAgIDAuMDAwMwogIEMwMEQgICAwLjAyODEgIDAuMDAwNCAgIDAuMDU2MSAgMC4wMDA2ICAgMC4wNDExICAwLjAwMDQgIC0wLjAwMTEgIDAuMDAwNCAgIC0wLjAwMSAgMC4wMDAzICAtMC4wMDg5ICAwLjAwMDQKICBDMDBFICAgMC4wMzk4ICAwLjAwMDUgICAwLjAzODIgIDAuMDAwNCAgIDAuMDQ4NiAgMC4wMDA1ICAgMC4wMDY5ICAwLjAwMDMgICAwLjAwNjkgIDAuMDAwNCAgIDAuMDAyOSAgMC4wMDA0CiAgQzAwRiAgIDAuMDQ2OSAgMC4wMDA1ICAgMC4wNjc5ICAwLjAwMDcgICAwLjAyOTYgIDAuMDAwNCAgLTAuMDE0NSAgMC4wMDA1ICAtMC4wMDM4ICAwLjAwMDQgICAwLjAwMDEgIDAuMDAwNAogIEMwMEcgICAwLjAzNjcgIDAuMDAwNCAgIDAuMDYxNSAgMC4wMDA2ICAgMC4wNDgyICAwLjAwMDUgICAwLjAwODQgIDAuMDAwNCAgIDAuMDIxNSAgMC4wMDA0ICAgMC4wMDgyICAwLjAwMDQKICBDMDBIICAgMC4wMzE3ICAwLjAwMDQgICAwLjA1MzIgIDAuMDAwNSAgIDAuMDQyOSAgMC4wMDA1ICAgMC4wMDc3ICAwLjAwMDQgIC0wLjAwMDIgIDAuMDAwMyAgIDAuMDExNCAgMC4wMDA0CiAgQzAwSSAgICAwLjA0MiAgMC4wMDA1ICAgMC4wNzI1ICAwLjAwMDcgICAwLjA0MTIgIDAuMDAwNSAgIDAuMDA1MiAgMC4wMDA1ICAgMC4wMDAzICAwLjAwMDQgICAwLjAyMzEgIDAuMDAwNQogIEMwMEogICAwLjA2MzMgIDAuMDAwNyAgICAgMC4wNSAgMC4wMDA2ICAgMC4wNjQzICAwLjAwMDcgIC0wLjAwOTYgIDAuMDAwNSAgLTAuMDA5NSAgMC4wMDA2ICAtMC4wMTczICAwLjAwMDUKICBDMDBLICAgMC4wMzY0ICAwLjAwMDQgICAwLjA3MTMgIDAuMDAwNyAgIDAuMDQ2OCAgMC4wMDA1ICAgMC4wMjE1ICAwLjAwMDUgICAwLjAwMDUgIDAuMDAwNCAgIC0wLjAxNiAgMC4wMDA1CiAgQzAwTCAgICAwLjAzOSAgMC4wMDA1ICAgMC4wNzEzICAwLjAwMDcgICAwLjA0ODkgIDAuMDAwNSAgLTAuMDI2MSAgMC4wMDA1ICAgMC4wMDI1ICAwLjAwMDQgICAwLjAwNDUgIDAuMDAwNQoKbG9vcF8KICBfZ2VvbV9ib25kLmF0b21fc2l0ZV9sYWJlbF8xCiAgX2dlb21fYm9uZC5hdG9tX3NpdGVfbGFiZWxfMgogIF9nZW9tX2JvbmQuZGlzdGFuY2UKICBfZ2VvbV9ib25kLmRpc3RhbmNlX3N1CiAgX2dlb21fYm9uZC5zaXRlX3N5bW1ldHJ5XzIKICBOaTAxICBQMiAgICAgMi4yMjkgIDAuMDAwNiAgLgogIE5pMDEgIFAxICAgIDIuMjM3MSAgMC4wMDA2ICAuCiAgTmkwMSAgUDMgICAgMi4yNDAyICAwLjAwMDYgIC4KICBOaTAxICBDMDA1ICAyLjA4ODkgIDAuMDAwNyAgLgogIE5pMDEgIEMwMDcgIDIuMDY5NSAgMC4wMDA3ICAuCiAgTmkwMSAgQzAwOCAgMi4wNjU2ICAwLjAwMDggIC4KICBOaTAxICBDMDA5ICAyLjA5OTcgIDAuMDAwNyAgLgogIE5pMDEgIEMwMEEgIDIuMDg4MSAgMC4wMDA3ICAuCiAgUDIgICAgUDEgICAgMi4xMjgyICAgMC4wMDEgIC4KICBQMiAgICBQMyAgICAyLjEyODggIDAuMDAxMiAgLgogIFAxICAgIFAzICAgIDIuMTIwNSAgMC4wMDExICAuCiAgQzAwNSAgQzAwNiAgMS41MTc2ICAgMC4wMDEgIC4KICBDMDA1ICBDMDA3ICAgIDEuNDIgIDAuMDAxMSAgLgogIEMwMDUgIEMwMDggIDEuNDI0MyAgIDAuMDAxICAuCiAgQzAwNiAgQzAwRCAgMS41Mjk4ICAwLjAwMTMgIC4KICBDMDA2ICBDMDBJICAxLjUzNDcgIDAuMDAxNCAgLgogIEMwMDYgIEMwMEsgIDEuNTI1MSAgMC4wMDEzICAuCiAgQzAwNyAgQzAwOSAgMS40MzY0ICAgMC4wMDEgIC4KICBDMDA3ICBIMDA3ICAgIDAuOTQgICAgICAgMCAgLgogIEMwMDggIEMwMEEgIDEuNDQyMyAgMC4wMDExICAuCiAgQzAwOCAgSDAwOCAgICAwLjk0ICAgICAgIDAgIC4KICBDMDA5ICBDMDBBICAxLjQ2MjggIDAuMDAxMSAgLgogIEMwMDkgIEMwMEIgIDEuNTM2OSAgMC4wMDExICAuCiAgQzAwQSAgQzAwQyAgMS41NDEzICAwLjAwMTEgIC4KICBDMDBCICBDMDBFICAxLjU0MDYgIDAuMDAxNCAgLgogIEMwMEIgIEMwMEcgIDEuNTQzMiAgMC4wMDEzICAuCiAgQzAwQiAgQzAwSCAgMS41MzA5ICAwLjAwMTIgIC4KICBDMDBDICBDMDBGICAxLjUzOTkgIDAuMDAxNCAgLgogIEMwMEMgIEMwMEogICAxLjUzOCAgMC4wMDE3ICAuCiAgQzAwQyAgQzAwTCAgMS41MzY2ICAwLjAwMTUgIC4KICBDMDBEICBIMDBhICAgIDAuOTcgICAgICAgMCAgLgogIEMwMEQgIEgwMGIgICAgMC45NyAgICAgICAwICAuCiAgQzAwRCAgSDAwYyAgICAwLjk3ICAgICAgIDAgIC4KICBDMDBFICBIMDBkICAgIDAuOTcgICAgICAgMCAgLgogIEMwMEUgIEgwMGUgICAgMC45NyAgICAgICAwICAuCiAgQzAwRSAgSDAwZiAgICAwLjk3ICAgICAgIDAgIC4KICBDMDBGICBIMDBnICAgIDAuOTcgICAgICAgMCAgLgogIEMwMEYgIEgwMGggICAgMC45NyAgICAgICAwICAuCiAgQzAwRiAgSDAwaSAgICAwLjk3ICAgICAgIDAgIC4KICBDMDBHICBIMDBqICAgIDAuOTcgICAgICAgMCAgLgogIEMwMEcgIEgwMGsgICAgMC45NyAgICAgICAwICAuCiAgQzAwRyAgSDAwbCAgICAwLjk3ICAgICAgIDAgIC4KICBDMDBIICBIMDBtICAgIDAuOTcgICAgICAgMCAgLgogIEMwMEggIEgwMG4gICAgMC45NyAgICAgICAwICAuCiAgQzAwSCAgSDAwbyAgICAwLjk3ICAgICAgIDAgIC4KICBDMDBJICBIMDBwICAgIDAuOTcgICAgICAgMCAgLgogIEMwMEkgIEgwMHEgICAgMC45NyAgICAgICAwICAuCiAgQzAwSSAgSDAwciAgICAwLjk3ICAgICAgIDAgIC4KICBDMDBKICBIMDBzICAgIDAuOTcgICAgICAgMCAgLgogIEMwMEogIEgwMHQgICAgMC45NyAgICAgICAwICAuCiAgQzAwSiAgSDAwdSAgICAwLjk3ICAgICAgIDAgIC4KICBDMDBLICBIMDB2ICAgIDAuOTcgICAgICAgMCAgLgogIEMwMEsgIEgwMHcgICAgMC45NyAgICAgICAwICAuCiAgQzAwSyAgSDAweCAgICAwLjk3ICAgICAgIDAgIC4KICBDMDBMICBIMDB5ICAgIDAuOTcgICAgICAgMCAgLgogIEMwMEwgIEggICAgICAgMC45NyAgICAgICAwICAuCiAgQzAwTCAgSGEgICAgICAwLjk3ICAgICAgIDAgIC4KCg==");
                widget.loadFromString(cifData);
            });
        </script>
    </div>
